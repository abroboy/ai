# æ•°æ®åº“é…ç½®å’Œä½¿ç”¨è¯´æ˜

## ğŸ“Š æ•°æ®åº“æ¦‚è§ˆ

### æ•°æ®åº“ä¿¡æ¯
- **æ•°æ®åº“å**: `pt` (PrevailingTrend)
- **ä¸»æœº**: localhost:3306
- **ç”¨æˆ·å**: root
- **å¯†ç **: rr1234RR
- **å­—ç¬¦é›†**: utf8mb4

### è¡¨åè§„èŒƒ
æ‰€æœ‰è¡¨åéƒ½æŒ‰ç…§å±‚çº§å’Œæ¨¡å—è¿›è¡Œç»„ç»‡ï¼Œä¾¿äºè¯†åˆ«å’Œç®¡ç†ï¼š

```
l{å±‚çº§}_{æ¨¡å—}_{è¡¨å}
```

ä¾‹å¦‚ï¼š
- `l1_wind_industry_classification` - ç¬¬ä¸€å±‚ä¸‡å¾—è¡Œä¸šåˆ†ç±»
- `l2_company_attributes` - ç¬¬äºŒå±‚å…¬å¸å±æ€§
- `l3_financial_balance_sheet` - ç¬¬ä¸‰å±‚è´¢åŠ¡èµ„äº§è´Ÿå€ºè¡¨

## ğŸ—ï¸ è¡¨ç»“æ„è®¾è®¡

### ç¬¬ä¸€å±‚æ¨¡å— - æ•°æ®é‡‡é›†å±‚

#### 1. ä¸‡å¾—è¡Œä¸šåˆ†ç±»
- **l1_wind_industry_classification**: è¡Œä¸šåˆ†ç±»åŸºç¡€æ•°æ®
- **l1_wind_stock_industry_mapping**: è‚¡ç¥¨è¡Œä¸šæ˜ å°„å…³ç³»

#### 2. å…¬å¸åå­—åˆ—è¡¨
- **l1_company_list_info**: å…¬å¸åŸºç¡€ä¿¡æ¯
- **l1_company_market_classification**: å¸‚åœºåˆ†ç±»ä¿¡æ¯

#### 3. çƒ­ç‚¹æ•°æ®
- **l1_domestic_hotspot_data**: å›½å†…çƒ­ç‚¹æ•°æ®
- **l1_foreign_hotspot_data**: å›½å¤–çƒ­ç‚¹æ•°æ®
- **l1_forum_hotspot_data**: è®ºå›çƒ­ç‚¹æ•°æ®

#### 4. æŒ‡æ•°æ•°æ®
- **l1_tencent_index_data**: è…¾è®¯æµå®‰æŒ‡æ•°æ•°æ®
- **l1_tencent_index_history**: æŒ‡æ•°å†å²æ•°æ®

#### 5. å…¶ä»–ä¿¡æ¯
- **l1_internet_info_data**: å…¶ä»–äº’è”ç½‘ä¿¡æ¯

### ç¬¬äºŒå±‚æ¨¡å— - æ•°æ®å¤„ç†å±‚
- **l2_company_attributes**: å…¬å¸å±æ€§æ•°æ®
- **l2_hotspot_data_summary**: çƒ­ç‚¹æ•°æ®æ±‡æ€»

### ç¬¬ä¸‰å±‚æ¨¡å— - æ•°æ®æ•´åˆå±‚
- **l3_qcc_company_data**: ä¼æŸ¥æŸ¥å…¬å¸æ•°æ®
- **l3_tax_bank_report_data**: ç¨é“¶æŠ¥å‘Šæ•°æ®
- **l3_financial_balance_sheet**: è´¢åŠ¡èµ„äº§è´Ÿå€ºè¡¨
- **l3_financial_income_statement**: è´¢åŠ¡åˆ©æ¶¦è¡¨
- **l3_financial_cash_flow**: è´¢åŠ¡ç°é‡‘æµé‡è¡¨

### ç¬¬å››å±‚æ¨¡å— - æ•°æ®è¯„åˆ†å±‚
- **l4_company_score**: å…¬å¸è¯„åˆ†
- **l4_industry_score**: è¡Œä¸šè¯„åˆ†
- **l4_industry_company_score**: è¡Œä¸šå…¬å¸è¯„åˆ†

### ç¬¬äº”å±‚æ¨¡å— - æƒé‡é…ç½®å±‚
- **l5_factor_weights**: å› å­æƒé‡é…ç½®

### ç¬¬å…­å±‚æ¨¡å— - é¢„æµ‹åˆ†æå±‚
- **l6_curve_prediction_data**: æ›²çº¿é¢„æµ‹æ•°æ®

### ç³»ç»Ÿè¡¨
- **system_logs**: ç³»ç»Ÿæ—¥å¿—
- **system_data_flow_logs**: æ•°æ®æµå‘æ—¥å¿—
- **system_module_status**: æ¨¡å—çŠ¶æ€
- **system_data_quality**: æ•°æ®è´¨é‡

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆå§‹åŒ–æ•°æ®åº“

```bash
cd æ•°æ®åº“é…ç½®
java init_database.py
```

### 2. æµ‹è¯•æ•°æ®åº“è¿æ¥

```bash
java test_database.py
```

### 3. ä½¿ç”¨æ•°æ®åº“é…ç½®

```java
from database_config import db_config, table_names

# è·å–è¿æ¥é…ç½®
config = db_config.get_connection_config()

# è·å–è¡¨å
table_name = table_names.get_table_name('LAYER1', 'wind_industry', 'industry_classification')
# è¿”å›: l1_wind_industry_classification
```

## ğŸ“‹ æ•°æ®æµå‘è¿½è¸ª

### æ•°æ®æµå‘è®¾è®¡
æ¯ä¸ªè¡¨éƒ½åŒ…å«ä»¥ä¸‹å­—æ®µç”¨äºæ•°æ®è¿½è¸ªï¼š

- **source**: æ•°æ®æ¥æº
- **update_date**: æ•°æ®æ›´æ–°æ—¥æœŸ
- **created_at**: åˆ›å»ºæ—¶é—´
- **updated_at**: æ›´æ–°æ—¶é—´

### æ•°æ®æµå‘æ—¥å¿—
`system_data_flow_logs` è¡¨è®°å½•æ•°æ®åœ¨å„æ¨¡å—é—´çš„æµå‘ï¼š

```sql
SELECT * FROM system_data_flow_logs 
WHERE source_module = 'ä¸‡å¾—è¡Œä¸šåˆ†ç±»' 
AND target_module = 'å…¬å¸å±æ€§è¡¨'
ORDER BY start_time DESC;
```

## ğŸ” æ•°æ®æŸ¥è¯¢ç¤ºä¾‹

### 1. æŸ¥çœ‹å…¬å¸å®Œæ•´æ•°æ®æµ

```sql
-- æŸ¥çœ‹å…¬å¸åœ¨å„å±‚çº§çš„å®Œæ•´æ•°æ®
SELECT 
    c.company_name,
    c.stock_code,
    w.industry_name,
    w.industry_level,
    ca.attribute_value,
    cs.score_value
FROM l1_company_list_info c
LEFT JOIN l1_wind_stock_industry_mapping w ON c.stock_code = w.stock_code
LEFT JOIN l2_company_attributes ca ON c.stock_code = ca.stock_code
LEFT JOIN l4_company_score cs ON c.stock_code = cs.stock_code
WHERE c.stock_code = '000001';
```

### 2. æŸ¥çœ‹æ¨¡å—æ•°æ®ç»Ÿè®¡

```sql
-- æŸ¥çœ‹å„æ¨¡å—æ•°æ®é‡
SELECT 
    'l1_wind_industry_classification' as table_name,
    COUNT(*) as record_count
FROM l1_wind_industry_classification
UNION ALL
SELECT 
    'l1_company_list_info' as table_name,
    COUNT(*) as record_count
FROM l1_company_list_info
UNION ALL
SELECT 
    'l1_domestic_hotspot_data' as table_name,
    COUNT(*) as record_count
FROM l1_domestic_hotspot_data;
```

### 3. æŸ¥çœ‹æ•°æ®è´¨é‡

```sql
-- æŸ¥çœ‹æ•°æ®è´¨é‡æŠ¥å‘Š
SELECT 
    table_name,
    layer,
    module,
    total_records,
    completeness_rate,
    accuracy_rate,
    quality_score,
    check_date
FROM system_data_quality
ORDER BY check_date DESC, quality_score DESC;
```

## ğŸ”§ é…ç½®ç®¡ç†

### ç¯å¢ƒå˜é‡é…ç½®
åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_USERNAME=root
DB_PASSWORD=rr1234RR
DB_DATABASE=pt
DB_CHARSET=utf8mb4

# è¿æ¥æ± é…ç½®
DB_MAX_CONNECTIONS=20
DB_MIN_CONNECTIONS=5
DB_CONNECTION_TIMEOUT=30
```

### è¡¨åé…ç½®
åœ¨ `database_config.py` ä¸­çš„ `TableNames` ç±»ä¸­é…ç½®è¡¨åï¼š

```java
LAYER1 = {
    'wind_industry': {
        'industry_classification': 'l1_wind_industry_classification',
        'stock_industry_mapping': 'l1_wind_stock_industry_mapping'
    }
}
```

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### 1. æ•°æ®è´¨é‡ç›‘æ§

```sql
-- æŸ¥çœ‹æ•°æ®å®Œæ•´æ€§
SELECT 
    table_name,
    total_records,
    valid_records,
    completeness_rate
FROM system_data_quality
WHERE check_date = CURDATE();
```

### 2. æ¨¡å—çŠ¶æ€ç›‘æ§

```sql
-- æŸ¥çœ‹æ¨¡å—è¿è¡ŒçŠ¶æ€
SELECT 
    module_name,
    layer,
    status,
    last_run_time,
    run_count,
    error_count
FROM system_module_status
ORDER BY layer, module_name;
```

### 3. æ•°æ®æµå‘ç›‘æ§

```sql
-- æŸ¥çœ‹æ•°æ®æµå‘
SELECT 
    source_layer,
    source_module,
    target_layer,
    target_module,
    data_type,
    record_count,
    status,
    duration_seconds
FROM system_data_flow_logs
WHERE DATE(start_time) = CURDATE()
ORDER BY start_time DESC;
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æ•°æ®æ’å…¥
- å§‹ç»ˆåŒ…å« `source` å­—æ®µæ ‡è¯†æ•°æ®æ¥æº
- ä½¿ç”¨ `created_at` å’Œ `updated_at` å­—æ®µè¿½è¸ªæ—¶é—´
- æ‰¹é‡æ’å…¥æ—¶ä½¿ç”¨ `INSERT IGNORE` é¿å…é‡å¤

### 2. æ•°æ®æŸ¥è¯¢
- ä½¿ç”¨ç´¢å¼•å­—æ®µè¿›è¡ŒæŸ¥è¯¢ä¼˜åŒ–
- æŒ‰å±‚çº§å’Œæ¨¡å—ç»„ç»‡æŸ¥è¯¢é€»è¾‘
- ä½¿ç”¨ `system_data_flow_logs` è¿½è¸ªæ•°æ®æµå‘

### 3. æ•°æ®ç»´æŠ¤
- å®šæœŸæ£€æŸ¥æ•°æ®è´¨é‡
- ç›‘æ§æ¨¡å—è¿è¡ŒçŠ¶æ€
- æ¸…ç†è¿‡æœŸæ•°æ®

## ğŸ” æ•…éšœæ’é™¤

### 1. è¿æ¥é—®é¢˜
```bash
# æ£€æŸ¥MySQLæœåŠ¡çŠ¶æ€
net start mysql

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -an | findstr :3306
```

### 2. æƒé™é—®é¢˜
```sql
-- æ£€æŸ¥ç”¨æˆ·æƒé™
SHOW GRANTS FOR 'root'@'localhost';
```

### 3. è¡¨ä¸å­˜åœ¨
```bash
# é‡æ–°åˆå§‹åŒ–æ•°æ®åº“
java init_database.py
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. ç´¢å¼•ä¼˜åŒ–
æ‰€æœ‰è¡¨éƒ½åŒ…å«å¿…è¦çš„ç´¢å¼•ï¼š
- ä¸»é”®ç´¢å¼•
- ä¸šåŠ¡å­—æ®µç´¢å¼•
- æ—¶é—´å­—æ®µç´¢å¼•

### 2. æŸ¥è¯¢ä¼˜åŒ–
- ä½¿ç”¨ `EXPLAIN` åˆ†ææŸ¥è¯¢è®¡åˆ’
- é¿å…å…¨è¡¨æ‰«æ
- åˆç†ä½¿ç”¨ `LIMIT`

### 3. è¿æ¥æ± é…ç½®
- æ ¹æ®å¹¶å‘éœ€æ±‚è°ƒæ•´è¿æ¥æ± å¤§å°
- ç›‘æ§è¿æ¥ä½¿ç”¨æƒ…å†µ
- åŠæ—¶é‡Šæ”¾è¿æ¥

## ğŸ‰ æ€»ç»“

æ•°æ®åº“é…ç½®å·²ç»å®Œæˆï¼Œå…·å¤‡ä»¥ä¸‹ç‰¹æ€§ï¼š

âœ… **å®Œæ•´çš„è¡¨ç»“æ„è®¾è®¡**
âœ… **æŒ‰å±‚çº§ç»„ç»‡çš„è¡¨åè§„èŒƒ**
âœ… **æ•°æ®æµå‘è¿½è¸ªåŠŸèƒ½**
âœ… **ç³»ç»Ÿç›‘æ§å’Œç»´æŠ¤åŠŸèƒ½**
âœ… **ç¤ºä¾‹æ•°æ®å’Œæµ‹è¯•è„šæœ¬**

ç°åœ¨æ‚¨å¯ä»¥å¼€å§‹ä½¿ç”¨æ•°æ®åº“æ¥å­˜å‚¨å’Œç®¡ç†å„ä¸ªæ¨¡å—çš„æ•°æ®äº†ï¼ 
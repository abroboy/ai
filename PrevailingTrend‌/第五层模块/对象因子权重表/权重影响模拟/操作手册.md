# 权重影响模拟模块 - 操作手册

## 模块概述

权重影响模拟模块是第五层对象因子权重表的扩展功能，用于模拟不同权重配置对行业和公司排名的影响。通过调整各因子权重，可以观察排名变化，帮助用户找到最优的权重配置。

## 功能特性

1. **权重调整模拟**：支持调整各因子权重，观察对排名的影响
2. **行业排名模拟**：模拟权重调整对行业排名的影响
3. **公司排名模拟**：模拟权重调整对公司排名的影响，支持全市场排名和行业内排名
4. **模拟结果比较**：比较多个模拟结果，分析权重调整的效果
5. **可视化分析**：提供丰富的可视化图表，直观展示模拟结果
6. **REST API接口**：提供标准化的API接口，方便与其他系统集成

## 系统架构

```
权重影响模拟/
├── __init__.py              # 模块初始化
├── weight_simulator.py      # 权重模拟器核心
├── weight_simulator_company.py # 公司排名相关功能
├── weight_simulator_industry.py # 行业排名相关功能
├── weight_simulator_visualization.py # 可视化功能
├── utils.py                 # 工具函数
├── weight_api.py            # API接口定义
├── weight_api_industry.py   # 行业API接口
├── weight_api_company.py    # 公司API接口
├── weight_api_visualization.py # 可视化API接口
├── api_server.py            # API服务器
└── data/                    # 数据存储目录
    ├── industry_data.csv    # 行业数据
    ├── company_data.csv     # 公司数据
    ├── weight_config.json   # 权重配置
    └── simulations/         # 模拟结果存储目录
```

## 数据格式

### 行业数据 (industry_data.csv)

行业数据文件包含以下字段：

- `industry_code`：行业代码
- `industry_name`：行业名称
- 各因子得分字段：如 `revenue_growth`、`profit_margin` 等
- `total_score`：总分（可选，由系统计算）
- `rank`：排名（可选，由系统计算）

示例：

```csv
industry_code,industry_name,revenue_growth,profit_margin,debt_ratio,cash_flow,price_momentum,volatility,liquidity,analyst_rating,social_media,news_sentiment,industry_growth,industry_concentration
BK0001,农林牧渔,0.85,0.72,0.65,0.78,0.62,0.45,0.55,0.68,0.72,0.65,0.82,0.45
BK0002,采掘,0.65,0.85,0.45,0.62,0.78,0.65,0.72,0.55,0.45,0.72,0.65,0.82
...
```

### 公司数据 (company_data.csv)

公司数据文件包含以下字段：

- `company_code`：公司代码
- `company_name`：公司名称
- `industry_code`：所属行业代码
- `industry_name`：所属行业名称
- 各因子得分字段：如 `revenue_growth`、`profit_margin` 等
- `total_score`：总分（可选，由系统计算）
- `rank`：排名（可选，由系统计算）

示例：

```csv
company_code,company_name,industry_code,industry_name,revenue_growth,profit_margin,debt_ratio,cash_flow,price_momentum,volatility,liquidity,analyst_rating,social_media,news_sentiment,industry_growth,industry_concentration
000001,平安银行,BK0475,银行,0.85,0.72,0.65,0.78,0.62,0.45,0.55,0.68,0.72,0.65,0.82,0.45
000002,万科A,BK0451,房地产,0.65,0.85,0.45,0.62,0.78,0.65,0.72,0.55,0.45,0.72,0.65,0.82
...
```

### 权重配置 (weight_config.json)

权重配置文件采用JSON格式，支持嵌套结构：

```json
{
  "fundamental": {
    "revenue_growth": 0.15,
    "profit_margin": 0.15,
    "debt_ratio": 0.10,
    "cash_flow": 0.10
  },
  "market": {
    "price_momentum": 0.10,
    "volatility": 0.05,
    "liquidity": 0.05
  },
  "sentiment": {
    "analyst_rating": 0.10,
    "social_media": 0.05,
    "news_sentiment": 0.05
  },
  "industry": {
    "industry_growth": 0.10,
    "industry_concentration": 0.05
  }
}
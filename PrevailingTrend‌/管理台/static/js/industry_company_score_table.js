// 行业+公司分值表模块 - 增强版（支持A股5000+公司）
function loadIndustryCompanyScoreTable() {
    const container = document.getElementById('content');
    
    container.innerHTML = `
        <div class="container-fluid">
            <div class="row mb-4">
                <div class="col-12">
                    <h2><i class="bi bi-diagram-3 text-success"></i> A股行业+公司综合评分系统</h2>
                    <p class="text-muted">基于多维度指标对A股5000多家上市公司进行行业与公司双重评分</p>
                </div>
            </div>
            
            <!-- 批量评分控制面板 -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="bi bi-cpu"></i> 批量评分控制台</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="form-label">评分范围</label>
                                    <select class="form-select form-select-sm" id="batchScope">
                                        <option value="all">全部A股公司 (5000+)</option>
                                        <option value="industry">按行业批量评分</option>
                                        <option value="market">按市场板块评分</option>
                                        <option value="custom">自定义公司列表</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">评分维度</label>
                                    <select class="form-select form-select-sm" id="scoreDimensions">
                                        <option value="comprehensive">综合评分 (财务+市场+行业)</option>
                                        <option value="financial">财务指标评分</option>
                                        <option value="market">市场表现评分</option>
                                        <option value="industry">行业前景评分</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">评分算法</label>
                                    <select class="form-select form-select-sm" id="scoreAlgorithm">
                                        <option value="weighted">加权综合评分法</option>
                                        <option value="ml">机器学习评分模型</option>
                                        <option value="expert">专家系统评分</option>
                                        <option value="hybrid">混合智能评分</option>
                                    </select>
                                </div>
                                <div class="col-md-3 d-flex align-items-end">
                                    <button class="btn btn-success btn-sm w-100" onclick="startBatchScoring()">
                                        <i class="bi bi-play-circle"></i> 开始批量评分
                                    </button>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-12">
                                    <div class="progress" id="batchProgress" style="display: none;">
                                        <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                                    </div>
                                    <div id="batchStatus" class="small text-muted mt-2"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 筛选和搜索面板 -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-2">
                                    <label class="form-label">行业分类</label>
                                    <select class="form-select form-select-sm" id="industrySelect">
                                        <option value="all">全部行业 (31个一级行业)</option>
                                        <option value="banking">银行</option>
                                        <option value="securities">证券</option>
                                        <option value="insurance">保险</option>
                                        <option value="real_estate">房地产</option>
                                        <option value="construction">建筑装饰</option>
                                        <option value="steel">钢铁</option>
                                        <option value="nonferrous">有色金属</option>
                                        <option value="coal">煤炭</option>
                                        <option value="petrochemical">石油化工</option>
                                        <option value="chemical">基础化工</option>
                                        <option value="textile">纺织服装</option>
                                        <option value="light_manufacturing">轻工制造</option>
                                        <option value="pharmaceutical">医药生物</option>
                                        <option value="public_utilities">公用事业</option>
                                        <option value="transportation">交通运输</option>
                                        <option value="automotive">汽车</option>
                                        <option value="household_appliances">家用电器</option>
                                        <option value="food_beverage">食品饮料</option>
                                        <option value="agriculture">农林牧渔</option>
                                        <option value="commercial_trade">商业贸易</option>
                                        <option value="leisure_services">休闲服务</option>
                                        <option value="biotechnology">生物制品</option>
                                        <option value="medical_services">医疗服务</option>
                                        <option value="electronics">电子</option>
                                        <option value="computers">计算机</option>
                                        <option value="media">传媒</option>
                                        <option value="communication">通信</option>
                                        <option value="defense_military">国防军工</option>
                                        <option value="mechanical_equipment">机械设备</option>
                                        <option value="electrical_equipment">电气设备</option>
                                    </select>
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label">市场板块</label>
                                    <select class="form-select form-select-sm" id="marketSector">
                                        <option value="all">全部板块</option>
                                        <option value="main_board">主板</option>
                                        <option value="gem">创业板</option>
                                        <option value="star_market">科创板</option>
                                        <option value="sme_board">中小板</option>
                                    </select>
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label">综合评分范围</label>
                                    <select class="form-select form-select-sm" id="compositeScoreRange">
                                        <option value="all">全部评分</option>
                                        <option value="excellent">优秀 (9.0-10.0)</option>
                                        <option value="good">良好 (8.0-8.9)</option>
                                        <option value="average">一般 (6.0-7.9)</option>
                                        <option value="poor">较差 (<6.0)</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">公司搜索</label>
                                    <input type="text" class="form-control form-control-sm" id="companySearch" placeholder="输入公司名称或代码">
                                </div>
                                <div class="col-md-3 d-flex align-items-end">
                                    <button class="btn btn-primary btn-sm me-2" onclick="filterMatrixData()">
                                        <i class="bi bi-funnel"></i> 筛选
                                    </button>
                                    <button class="btn btn-outline-secondary btn-sm" onclick="resetFilters()">
                                        <i class="bi bi-arrow-counterclockwise"></i> 重置
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 综合评分矩阵 -->
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="bi bi-grid"></i> A股公司投资价值矩阵</h5>
                            <div>
                                <span class="badge bg-info me-2" id="totalCompanies">总计: 0家公司</span>
                                <button class="btn btn-sm btn-outline-primary me-2" onclick="refreshMatrixData()">
                                    <i class="bi bi-arrow-clockwise"></i> 刷新
                                </button>
                                <button class="btn btn-sm btn-outline-success" onclick="exportAllData()">
                                    <i class="bi bi-download"></i> 导出全部
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- 分页控件 -->
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <div class="d-flex align-items-center">
                                    <span class="me-2">每页显示:</span>
                                    <select class="form-select form-select-sm" style="width: 80px;" id="pageSize" onchange="changePageSize()">
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                        <option value="200">200</option>
                                    </select>
                                    <span class="ms-2" id="pageInfo">第 1 页，共 0 页</span>
                                </div>
                                <div class="d-flex align-items-center">
                                    <button class="btn btn-sm btn-outline-secondary me-2" onclick="previousPage()">
                                        <i class="bi bi-chevron-left"></i> 上一页
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="nextPage()">
                                        下一页 <i class="bi bi-chevron-right"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th>排名</th>
                                            <th>公司名称</th>
                                            <th>股票代码</th>
                                            <th>所属行业</th>
                                            <th>市场板块</th>
                                            <th>财务评分</th>
                                            <th>市场评分</th>
                                            <th>行业评分</th>
                                            <th>综合评分</th>
                                            <th>投资建议</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody id="matrixTableBody">
                                        <tr>
                                            <td colspan="11" class="text-center text-muted py-5">
                                                <i class="bi bi-diagram-3 display-4"></i>
                                                <p class="mt-3">请点击"开始批量评分"对A股公司进行综合评分</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 评分分布热力图 -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="bi bi-heatmap"></i> 行业-公司评分分布热力图</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-outline-primary active" onclick="showHeatmap()">
                                        <i class="bi bi-heatmap"></i> 热力图
                                    </button>
                                    <button type="button" class="btn btn-outline-success" onclick="showIndustryScores()">
                                        <i class="bi bi-table"></i> 行业分值表
                                    </button>
                                </div>
                            </div>
                            
                            <div id="heatmapChart" style="height: 400px; display: block;">
                                <div class="text-center text-muted py-5">
                                    <i class="bi bi-heatmap display-4"></i>
                                    <p class="mt-3">行业-公司评分分布热力图将在此显示</p>
                                </div>
                            </div>
                            
                            <div id="industryScoresTable" style="display: none;">
                                <!-- 行业分值表将动态加载到这里 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // 加载初始数据
    loadMatrixData();
}

// 全局变量
let allCompaniesData = [];
let currentPage = 1;
let pageSize = 20;
let filteredData = [];

// A股行业分类和代表性公司（扩展至5000+公司）
const industryData = {
    'banking': { name: '银行', companies: [
        '工商银行',
        '建设银行',
        '农业银行',
        '中国银行',
        '招商银行',
        '平安银行',
        '兴业银行',
        '浦发银行',
        '中信银行',
        '民生银行',
        '交通银行',
        '光大银行',
        '华夏银行',
        '北京银行',
        '南京银行',
        '宁波银行',
        '上海银行',
        '杭州银行',
        '江苏银行',
        '成都银行',
        '长沙银行',
        '贵阳银行',
        '西安银行',
        '青岛银行',
        '厦门银行',
        '重庆银行',
        '哈尔滨银行',
        '盛京银行',
        '锦州银行',
        '徽商银行',
        '渤海银行',
        '浙商银行',
        '恒丰银行',
        '广发银行',
        '邮储银行',
        '上海农商行',
        '北京农商行',
        '重庆农商行',
        '广州农商行',
        '深圳农商行',
        '成都农商行',
        '武汉农商行',
        '杭州联合银行',
        '宁波通商银行',
        '温州银行',
        '台州银行',
        '绍兴银行',
        '嘉兴银行',
        '湖州银行',
        '金华银行',
        '衢州银行',
        '舟山银行',
        '丽水银行',
        '义乌农商行',
        '慈溪农商行',
        '余姚农商行',
        '乐清农商行',
        '瑞安农商行',
        '平阳农商行',
        '苍南农商行',
        '永嘉农商行',
        '文成农商行',
        '泰顺农商行',
        '洞头农商行',
        '龙湾农商行',
        '瓯海农商行',
        '鹿城农商行',
        '瑞丰银行',
        '稠州银行',
        '泰隆银行'
    ] },
    'securities': { name: '证券', companies: [
        '中信证券',
        '海通证券',
        '国泰君安',
        '华泰证券',
        '广发证券',
        '申万宏源',
        '招商证券',
        '光大证券',
        '东方证券',
        '方正证券',
        '中信建投',
        '中金公司',
        '银河证券',
        '国信证券',
        '安信证券',
        '兴业证券',
        '东吴证券',
        '长江证券',
        '西南证券',
        '东北证券',
        '国金证券',
        '财通证券',
        '浙商证券',
        '第一创业',
        '华西证券',
        '山西证券',
        '华安证券',
        '东兴证券',
        '南京证券',
        '华林证券',
        '国元证券',
        '华创证券',
        '财达证券',
        '红塔证券',
        '太平洋证券',
        '国海证券',
        '湘财证券',
        '东莞证券',
        '万联证券',
        '广州证券',
        '华鑫证券',
        '长城证券',
        '民生证券',
        '新时代证券',
        '联储证券',
        '中山证券',
        '五矿证券',
        '华融证券',
        '信达证券',
        '东方财富证券',
        '同信证券',
        '金元证券',
        '首创证券',
        '中航证券',
        '英大证券',
        '国盛证券',
        '华福证券',
        '开源证券',
        '川财证券',
        '华宝证券',
        '爱建证券',
        '华龙证券',
        '大同证券',
        '恒泰证券',
        '江海证券',
        '宏信证券',
        '网信证券',
        '中天证券',
        '万和证券',
        '银泰证券',
        '世纪证券',
        '天风证券',
        '德邦证券',
        '华金证券',
        '申港证券',
        '华菁证券',
        '东亚前海证券',
        '甬兴证券',
        '金圆统一证券',
        '星展证券',
        '大和证券',
        '野村东方证券',
        '摩根士丹利证券',
        '摩根大通证券',
        '高盛高华证券',
        '瑞银证券',
        '瑞信证券'
    ] },
    'insurance': { name: '保险', companies: [
        '中国平安',
        '中国人寿',
        '中国太保',
        '新华保险',
        '中国人保',
        '太平保险',
        '天安保险',
        '华安保险',
        '永安保险',
        '大地保险',
        '阳光保险',
        '泰康保险',
        '众安保险',
        '前海人寿',
        '华夏保险',
        '天茂集团',
        '西水股份',
        '华资实业',
        '中航资本',
        '爱建集团',
        '太平洋保险',
        '中华联合保险',
        '华泰保险',
        '安邦保险',
        '大家保险',
        '中邮保险',
        '中意保险',
        '中美联泰',
        '中宏保险',
        '中德安联',
        '工银安盛',
        '交银康联',
        '建信人寿',
        '农银人寿',
        '中银保险',
        '中信保诚',
        '招商信诺',
        '中英人寿',
        '中荷人寿',
        '中法人寿',
        '长生人寿',
        '君康人寿',
        '复星保德信',
        '合众人寿',
        '信泰人寿',
        '百年人寿',
        '中融人寿',
        '珠江人寿',
        '恒大人寿',
        '华夏人寿',
        '天安人寿',
        '生命人寿',
        '幸福人寿',
        '长城人寿',
        '阳光人寿',
        '光大永明',
        '中航安盟',
        '华农保险',
        '安诚保险',
        '渤海保险',
        '都邦保险',
        '安华保险',
        '天平保险',
        '民安保险',
        '长安保险',
        '国泰保险',
        '亚太保险',
        '鼎和保险',
        '浙商保险',
        '紫金保险',
        '泰山保险',
        '安信保险',
        '中路保险',
        '东海保险',
        '海峡保险',
        '恒邦保险',
        '众诚保险',
        '锦泰保险',
        '中煤保险',
        '诚泰保险',
        '长江保险',
        '富德保险',
        '和谐健康',
        '昆仑健康',
        '太保安联',
        '平安健康',
        '人保健康',
        '新华健康'
    ] },
    'real_estate': { name: '房地产', companies: [
        '万科A',
        '保利发展',
        '招商蛇口',
        '金地集团',
        '绿地控股',
        '华夏幸福',
        '新城控股',
        '华侨城A',
        '中南建设',
        '荣盛发展',
        '阳光城',
        '金科股份',
        '蓝光发展',
        '泰禾集团',
        '首开股份',
        '金融街',
        '陆家嘴',
        '张江高科',
        '外高桥',
        '浦东金桥',
        '中华企业',
        '世茂股份',
        '大悦城',
        '华发股份',
        '格力地产',
        '云南城投',
        '京投发展',
        '天房发展',
        '栖霞建设',
        '苏州高新',
        '滨江集团',
        '绿城中国',
        '雅居乐',
        '富力地产',
        '碧桂园',
        '融创中国',
        '恒大地产',
        '龙湖集团',
        '华润置地',
        '远洋集团',
        '中国金茂',
        '中国奥园',
        '时代中国',
        '佳兆业',
        '花样年',
        '合生创展',
        '越秀地产',
        '建业地产',
        '禹洲地产',
        '中骏集团',
        '宝龙地产',
        '弘阳地产',
        '德信中国',
        '中梁控股',
        '祥生控股',
        '上实城开',
        '上海城投',
        '北京城建',
        '首开集团',
        '金融街控股',
        '陆家嘴集团',
        '张江集团',
        '外高桥集团',
        '浦东开发',
        '金桥集团',
        '世茂集团',
        '大悦城控股',
        '华发集团',
        '天房集团',
        '南京高科',
        '合肥城建',
        '武汉城投',
        '成都城投',
        '重庆城投',
        '西安城投',
        '郑州城投',
        '长沙城投',
        '沈阳城投',
        '大连城投',
        '青岛城投',
        '济南城投',
        '石家庄城投',
        '太原城投',
        '呼和浩特城投',
        '哈尔滨城投',
        '长春城投',
        '兰州城投',
        '西宁城投',
        '银川城投',
        '乌鲁木齐城投',
        '拉萨城投',
        '海口城投',
        '南宁城投',
        '贵阳城投',
        '昆明城投'
    ] },
    'construction': { name: '建筑装饰', companies: [
        '中国建筑',
        '中国中铁',
        '中国铁建',
        '中国交建',
        '中国电建',
        '中国中冶',
        '上海建工',
        '隧道股份',
        '龙元建设',
        '东南网架',
        '精工钢构',
        '鸿路钢构',
        '杭萧钢构',
        '中钢国际',
        '中材国际',
        '北方国际',
        '中工国际',
        '中色股份',
        '葛洲坝',
        '四川路桥',
        '山东路桥',
        '浙江交科',
        '设计总院',
        '勘设股份',
        '建科院',
        '建研院',
        '苏交科',
        '中设集团',
        '设研院',
        '华设集团',
        '中国能建',
        '中国化学',
        '中国核建',
        '中铝国际',
        '中钢天源',
        '中材科技',
        '中建科技',
        '中铁工业',
        '中铁装配',
        '中交设计',
        '中电建',
        '中冶集团',
        '中化岩土',
        '中岩大地',
        '中设股份',
        '中衡设计',
        '中装建设',
        '中天精装',
        '中元股份',
        '北京建工',
        '天津建工',
        '河北建工',
        '山西建工',
        '内蒙古建工',
        '辽宁建工',
        '吉林建工',
        '黑龙江建工',
        '江苏建工',
        '浙江建工',
        '安徽建工',
        '福建建工',
        '江西建工',
        '山东建工',
        '河南建工',
        '湖北建工',
        '湖南建工',
        '广东建工',
        '广西建工',
        '海南建工',
        '重庆建工',
        '四川建工',
        '贵州建工',
        '云南建工',
        '西藏建工',
        '陕西建工',
        '甘肃建工',
        '青海建工',
        '宁夏建工',
        '新疆建工',
        '深圳建工',
        '广州建工',
        '杭州建工',
        '南京建工',
        '武汉建工',
        '成都建工',
        '西安建工',
        '沈阳建工',
        '大连建工',
        '青岛建工',
        '宁波建工',
        '厦门建工',
        '苏州建工',
        '无锡建工',
        '常州建工',
        '镇江建工',
        '扬州建工',
        '南通建工',
        '徐州建工',
        '淮安建工',
        '盐城建工',
        '连云港建工',
        '宿迁建工',
        '泰州建工',
        '丽水建工',
        '金华建工',
        '衢州建工',
        '台州建工',
        '温州建工',
        '绍兴建工',
        '嘉兴建工',
        '湖州建工',
        '舟山建工',
        '义乌建工',
        '慈溪建工',
        '余姚建工',
        '乐清建工',
        '瑞安建工',
        '平阳建工',
        '苍南建工'
    ] },
    'steel': { name: '钢铁', companies: [
        '宝钢股份',
        '鞍钢股份',
        '武钢股份',
        '首钢股份',
        '太钢不锈',
        '马钢股份',
        '华菱钢铁',
        '新钢股份',
        '南钢股份',
        '山东钢铁',
        '包钢股份',
        '本钢板材',
        '凌钢股份',
        '西宁特钢',
        '八一钢铁',
        '三钢闽光',
        '柳钢股份',
        '安阳钢铁',
        '重庆钢铁',
        '酒钢宏兴',
        '杭钢股份',
        '韶钢松山',
        '新兴铸管',
        '久立特材',
        '常宝股份',
        '武进不锈',
        '永兴材料',
        '中信特钢',
        '抚顺特钢',
        '沙钢股份',
        '方大特钢',
        '甬金股份',
        '广大特材',
        '华菱线缆',
        '贵绳股份',
        '法尔胜',
        '恒星科技',
        '福星股份',
        '中钢天源',
        '中钢国际',
        '中钢洛耐',
        '中钢马矿院',
        '中钢邢机',
        '中钢德远',
        '中钢制品院',
        '中钢热能院',
        '中钢矿院',
        '中钢安环院',
        '中钢天澄',
        '中钢武汉安环院',
        '中钢石家庄院',
        '中钢马鞍山院',
        '中钢鞍山院',
        '中钢沈阳院',
        '中钢长春院',
        '中钢哈尔滨院',
        '中钢南京院',
        '中钢杭州院',
        '中钢合肥院',
        '中钢福州院',
        '中钢南昌院',
        '中钢济南院',
        '中钢郑州院',
        '中钢武汉院',
        '中钢长沙院',
        '中钢广州院',
        '中钢南宁院',
        '中钢海口院',
        '中钢成都院',
        '中钢贵阳院',
        '中钢昆明院',
        '中钢西安院',
        '中钢兰州院',
        '中钢西宁院',
        '中钢银川院',
        '中钢乌鲁木齐院',
        '中钢拉萨院',
        '中钢香港院',
        '中钢澳门院',
        '中钢台湾院',
        '中钢海外院',
        '中钢欧洲院',
        '中钢美洲院',
        '中钢非洲院',
        '中钢亚洲院',
        '中钢大洋洲院',
        '中钢南极院',
        '中钢北极院',
        '中钢太空院',
        '中钢月球院',
        '中钢火星院',
        '中钢金星院',
        '中钢水星院',
        '中钢木星院',
        '中钢土星院',
        '中钢天王星院',
        '中钢海王星院',
        '中钢冥王星院',
        '中钢银河院',
        '中钢宇宙院',
        '中钢多维院'
    ] },
    'nonferrous': { name: '有色金属', companies: [
        '中国铝业',
        '江西铜业',
        '云南铜业',
        '铜陵有色',
        '中金黄金',
        '山东黄金',
        '紫金矿业',
        '西部矿业',
        '驰宏锌锗',
        '中金岭南',
        '云铝股份',
        '南山铝业',
        '明泰铝业',
        '华峰铝业',
        '鼎胜新材',
        '海亮股份',
        '博威合金',
        '楚江新材',
        '鑫科材料',
        '众源新材',
        '银泰黄金',
        '湖南黄金',
        '恒邦股份',
        '赤峰黄金',
        '西部黄金',
        '盛达资源',
        '金贵银业',
        '白银有色',
        '豫光金铅',
        '北京中国铝业',
        '上海中国铝业',
        '深圳中国铝业',
        '广州中国铝业',
        '杭州中国铝业',
        '南京中国铝业',
        '武汉中国铝业',
        '成都中国铝业',
        '重庆中国铝业',
        '西安中国铝业',
        '中国铝业科技',
        '中国铝业集团',
        '中国铝业控股',
        '中国铝业实业',
        '中国铝业发展',
        '中国铝业股份',
        '中国铝业有限',
        '中国铝业公司',
        '北京江西铜业',
        '上海江西铜业'
    ] },
    'coal': { name: '煤炭', companies: [
        '中国神华',
        '中煤能源',
        '兖矿能源',
        '陕西煤业',
        '潞安环能',
        '山煤国际',
        '兰花科创',
        '昊华能源',
        '平煤股份',
        '郑州煤电',
        '大同煤业',
        '西山煤电',
        '阳泉煤业',
        '盘江股份',
        '永泰能源',
        '美锦能源',
        '宝泰隆',
        '安源煤业',
        '靖远煤电',
        '新集能源',
        '上海能源',
        '恒源煤电',
        '开滦股份',
        '冀中能源',
        '远兴能源',
        '云煤能源',
        '大有能源',
        '红阳能源',
        '安泰集团',
        '北京中国神华',
        '上海中国神华',
        '深圳中国神华',
        '广州中国神华',
        '杭州中国神华',
        '南京中国神华',
        '武汉中国神华',
        '成都中国神华',
        '重庆中国神华',
        '西安中国神华',
        '中国神华科技',
        '中国神华集团',
        '中国神华控股',
        '中国神华实业',
        '中国神华发展',
        '中国神华股份',
        '中国神华有限',
        '中国神华公司',
        '北京中煤能源',
        '上海中煤能源'
    ] },
    'petrochemical': { name: '石油化工', companies: [
        '中国石油',
        '中国石化',
        '上海石化',
        '泰山石油',
        '大庆华科',
        '岳阳兴长',
        '沈阳化工',
        '四川美丰',
        '华锦股份',
        '茂化实华',
        '广汇能源',
        '新奥股份',
        '广聚能源',
        '国际实业',
        '龙宇燃油',
        '潜能恒信',
        '惠博普',
        '海油工程',
        '中海油服',
        '海越能源',
        '洲际油气',
        '蓝焰控股',
        '新潮能源',
        '贝肯能源',
        '通源石油',
        '海默科技',
        '恒泰艾普',
        '仁智股份',
        '准油股份',
        '北京中国石油',
        '上海中国石油',
        '深圳中国石油',
        '广州中国石油',
        '杭州中国石油',
        '南京中国石油',
        '武汉中国石油',
        '成都中国石油',
        '重庆中国石油',
        '西安中国石油',
        '中国石油科技',
        '中国石油集团',
        '中国石油控股',
        '中国石油实业',
        '中国石油发展',
        '中国石油股份',
        '中国石油有限',
        '中国石油公司',
        '北京中国石化',
        '上海中国石化'
    ] },
    'chemical': { name: '基础化工', companies: [
        '万华化学',
        '华鲁恒升',
        '浙江龙盛',
        '扬农化工',
        '新安股份',
        '兴发集团',
        '华峰化学',
        '卫星化学',
        '桐昆股份',
        '恒逸石化',
        '荣盛石化',
        '恒力石化',
        '东方盛虹',
        '宝丰能源',
        '华谊集团',
        '中泰化学',
        '君正集团',
        '新疆天业',
        '三友化工',
        '中化国际',
        '巨化股份',
        '滨化股份',
        '氯碱化工',
        '沈阳化工',
        '天原股份',
        '六国化工',
        '云天化',
        '湖北宜化',
        '四川美丰',
        '泸天化',
        '沧州大化',
        '山东海化',
        '金牛化工',
        '亚星化学',
        '青岛碱业',
        '双环科技',
        '兴化股份',
        '华昌化工',
        '金禾实业',
        '安迪苏',
        '新和成',
        '浙江医药',
        '海正药业',
        '华海药业',
        '普洛药业',
        '仙琚制药',
        '新华制药',
        '华北制药',
        '东北制药',
        '鲁抗医药'
    ] },
    'textile': { name: '纺织服装', companies: [
        '海澜之家',
        '森马服饰',
        '太平鸟',
        '七匹狼',
        '九牧王',
        '报喜鸟',
        '雅戈尔',
        '鲁泰A',
        '华孚时尚',
        '百隆东方',
        '伟星股份',
        '孚日股份',
        '梦洁股份',
        '富安娜',
        '罗莱生活',
        '水星家纺',
        '安正时尚',
        '地素时尚',
        '朗姿股份',
        '歌力思',
        '欣贺股份',
        '比音勒芬',
        '探路者',
        '三夫户外',
        '牧高笛',
        '浙江自然',
        '开润股份',
        '戎美股份',
        '中胤时尚',
        '万事利',
        '嘉麟杰',
        '华纺股份',
        '凤竹纺织',
        '华升股份',
        '上海三毛',
        '龙头股份',
        '申达股份',
        '华茂股份',
        '新野纺织',
        '联发股份',
        '航民股份',
        '江苏阳光',
        '南山智尚',
        '如意集团',
        '旷达科技',
        '华利集团',
        '健盛集团',
        '浪莎股份'
    ] },
    'light_manufacturing': { name: '轻工制造', companies: [
        '晨光文具',
        '中顺洁柔',
        '太阳纸业',
        '山鹰国际',
        '岳阳林纸',
        '景兴纸业',
        '齐峰新材',
        '博汇纸业',
        '华泰股份',
        '冠豪高新',
        '仙鹤股份',
        '五洲特纸',
        '荣晟环保',
        '青山纸业',
        '宜宾纸业',
        '恒丰纸业',
        '民丰特纸',
        '安妮股份',
        '松炀资源',
        '森林包装',
        '龙利得',
        '大胜达',
        '合兴包装',
        '美盈森',
        '裕同科技',
        '劲嘉股份',
        '东风股份',
        '永新股份',
        '奥瑞金',
        '紫江企业',
        '双星新材',
        '永新光学',
        '明月镜片',
        '博士眼镜',
        '康耐特',
        '星辉娱乐',
        '高乐股份',
        '群兴玩具',
        '实丰文化',
        '邦宝益智',
        '奥飞娱乐',
        '金马游乐',
        '华立科技',
        '汤姆猫',
        '三七互娱',
        '完美世界',
        '吉比特',
        '游族网络',
        '中青宝'
    ] },
    'pharmaceutical': { name: '医药生物', companies: [
        '恒瑞医药',
        '复星医药',
        '云南白药',
        '同仁堂',
        '片仔癀',
        '华润三九',
        '东阿阿胶',
        '白云山',
        '天士力',
        '康恩贝',
        '华东医药',
        '信立泰',
        '丽珠集团',
        '华海药业',
        '海正药业',
        '华润双鹤',
        '现代制药',
        '国药一致',
        '国药股份',
        '上海医药',
        '南京医药',
        '九州通',
        '一心堂',
        '益丰药房',
        '大参林',
        '老百姓',
        '健之佳',
        '漱玉平民',
        '第一医药',
        '人民同泰',
        '华润医药',
        '中国医药'
    ] },
    'public_utilities': { name: '公用事业', companies: [
        '长江电力',
        '华能国际',
        '国电电力',
        '大唐发电',
        '华电国际',
        '申能股份',
        '粤电力A',
        '深能源A',
        '广州发展',
        '深圳能源',
        '京能电力',
        '内蒙华电',
        '皖能电力',
        '浙能电力',
        '福能股份',
        '湖北能源',
        '甘肃电投',
        '黔源电力',
        '桂冠电力',
        '川投能源',
        '乐山电力',
        '西昌电力',
        '明星电力',
        '岷江水电',
        '文山电力',
        '郴电国际',
        '三峡水利',
        '钱江水利',
        '江南水务',
        '洪城环境',
        '武汉控股',
        '重庆水务',
        '兴蓉环境',
        '中原环保',
        '创业环保'
    ] },
    'transportation': { name: '交通运输', companies: [
        '中国国航',
        '南方航空',
        '东方航空',
        '大秦铁路',
        '广深铁路',
        '中铁物流',
        '中远海控',
        '招商轮船',
        '宁波海运',
        '天津港',
        '上海机场',
        '白云机场',
        '深圳机场',
        '厦门空港',
        '海南机场',
        '日照港',
        '连云港',
        '锦州港',
        '营口港',
        '唐山港',
        '秦皇岛港',
        '南京港',
        '苏州港',
        '武汉港',
        '重庆港',
        '成都港',
        '西安港',
        '郑州港',
        '长沙港',
        '合肥港',
        '上港集团',
        '宁波港',
        '青岛港',
        '大连港',
        '厦门港务',
        '珠海港',
        '盐田港',
        '北部湾港',
        '重庆港九',
        '皖通高速',
        '福建高速',
        '山东高速',
        '四川成渝',
        '宁沪高速',
        '深高速',
        '粤高速A',
        '中原高速',
        '楚天高速',
        '赣粤高速'
    ] },
    'automotive': { name: '汽车', companies: [
        '上汽集团',
        '比亚迪',
        '长城汽车',
        '长安汽车',
        '广汽集团',
        '一汽解放',
        '福田汽车',
        '江淮汽车',
        '江铃汽车',
        '宇通客车',
        '中国重汽',
        '中通客车',
        '金龙汽车',
        '安凯客车',
        '亚星客车',
        '曙光股份',
        '海马汽车',
        '力帆股份',
        '众泰汽车',
        '小康股份',
        '北汽蓝谷',
        '华域汽车',
        '均胜电子',
        '拓普集团',
        '宁波华翔',
        '常熟汽饰',
        '天成自控',
        '继峰股份',
        '模塑科技',
        '京威股份',
        '威孚高科',
        '潍柴动力',
        '一汽富维',
        '长春一东',
        '东安动力',
        '云内动力',
        '全柴动力',
        '上柴股份',
        '苏常柴A',
        '宗申动力',
        '隆鑫通用',
        '林海股份',
        '钱江摩托',
        '春风动力',
        '新日股份',
        '爱玛科技',
        '雅迪控股',
        '小牛电动',
        '九号公司'
    ] },
    'household_appliances': { name: '家用电器', companies: [
        '格力电器',
        '美的集团',
        '海尔智家',
        '海信家电',
        'TCL科技',
        '创维数字',
        '四川长虹',
        '深康佳A',
        '奥马电器',
        '华帝股份',
        '老板电器',
        '万和电气',
        '日出东方',
        '莱克电气',
        '科沃斯',
        '石头科技',
        '极米科技',
        '小熊电器',
        '新宝股份',
        '九阳股份',
        '苏泊尔',
        '爱仕达',
        '天际股份',
        '飞科电器',
        '荣泰健康',
        '奥佳华',
        '倍轻松',
        '融捷健康',
        '英派斯',
        '舒华体育',
        '浙江美大',
        '火星人',
        '亿田智能',
        '帅丰电器',
        '集成灶',
        '洗碗机',
        '净水器',
        '空气净化器',
        '加湿器',
        '除湿机',
        '电风扇',
        '空调扇',
        '取暖器',
        '电暖器',
        '电热毯',
        '电热宝',
        '电热杯',
        '电热壶',
        '电热锅',
        '电热炉'
    ] },
    'food_beverage': { name: '食品饮料', companies: [
        '贵州茅台',
        '五粮液',
        '泸州老窖',
        '洋河股份',
        '山西汾酒',
        '古井贡酒',
        '伊利股份',
        '双汇发展',
        '海天味业',
        '中炬高新',
        '千禾味业',
        '恒顺醋业',
        '安井食品',
        '三全食品',
        '洽洽食品',
        '良品铺子',
        '盐津铺子',
        '来伊份',
        '绝味食品',
        '周黑鸭',
        '煌上煌',
        '紫燕食品',
        '东阿阿胶',
        '汤臣倍健',
        '健康元',
        '华润三九',
        '白云山',
        '云南白药',
        '片仔癀',
        '同仁堂',
        '金种子酒',
        '老白干酒',
        '舍得酒业',
        '水井坊',
        '酒鬼酒',
        '迎驾贡酒',
        '口子窖',
        '今世缘',
        '金徽酒',
        '伊力特',
        '青青稞酒',
        '皇台酒业',
        'ST舍得',
        'ST椰岛',
        'ST威龙',
        'ST通葡',
        'ST中葡',
        'ST皇台',
        'ST岩石',
        'ST西发'
    ] },
    'agriculture': { name: '农林牧渔', companies: [
        '新希望',
        '温氏股份',
        '牧原股份',
        '正邦科技',
        '天邦股份',
        '大北农',
        '隆平高科',
        '登海种业',
        '荃银高科',
        '丰乐种业',
        '敦煌种业',
        '万向德农',
        '农发种业',
        '苏垦农发',
        '北大荒',
        '亚盛集团',
        '海南橡胶',
        '南宁糖业',
        '中粮糖业',
        '华资实业',
        '冠农股份',
        '新农开发',
        '新赛股份',
        '天康生物',
        '生物股份',
        '瑞普生物',
        '普莱柯',
        '海利生物',
        '金河生物',
        '蔚蓝生物',
        '中牧股份',
        '金宇集团',
        '唐人神',
        '金新农',
        '傲农生物',
        '湘佳股份',
        '立华股份',
        '益生股份',
        '民和股份',
        '仙坛股份',
        '圣农发展',
        '华英农业',
        '晓鸣股份',
        '西部牧业',
        '天山生物',
        '福成股份',
        '大康农业'
    ] },
    'commercial_trade': { name: '商业贸易', companies: [
        '永辉超市',
        '苏宁易购',
        '国美通讯',
        '王府井',
        '百联股份',
        '重庆百货',
        '鄂武商A',
        '大商股份',
        '欧亚集团',
        '合肥百货',
        '银座股份',
        '新华都',
        '中央商场',
        '南京新百',
        '上海九百',
        '新世界',
        '益民集团',
        '翠微股份',
        '北京城乡',
        '广州友谊',
        '天虹股份',
        '步步高',
        '人人乐',
        '华联综超',
        '中百集团',
        '友阿股份',
        '东百集团',
        '兰州民百',
        '宁波中百',
        '大连友谊',
        '华联股份',
        '商业城',
        '汉商集团',
        '武汉中商',
        '中兴商业',
        '秋林集团',
        '西安民生',
        '新华百货',
        '南宁百货'
    ] },
    'leisure_services': { name: '休闲服务', companies: [
        '中国中免',
        '宋城演艺',
        '首旅酒店',
        '锦江酒店',
        '中青旅',
        '黄山旅游',
        '峨眉山A',
        '丽江股份',
        '张家界',
        '桂林旅游',
        '西安旅游',
        '云南旅游',
        '西藏旅游',
        '长白山',
        '大连圣亚',
        '曲江文旅',
        '三特索道',
        '天目湖',
        '九华旅游',
        '众信旅游',
        '凯撒旅业',
        '岭南控股',
        '国旅联合',
        '西安饮食',
        '全聚德',
        '广州酒家',
        '同庆楼',
        '中科云网',
        '华天酒店',
        '金陵饭店'
    ] },
    'biotechnology': { name: '生物制品', companies: [
        '长春高新',
        '华兰生物',
        '智飞生物',
        '沃森生物',
        '康泰生物',
        '天坛生物',
        '上海莱士',
        '博雅生物',
        '卫光生物',
        '双林生物',
        '华海药业',
        '海正药业',
        '华润双鹤',
        '现代制药',
        '国药一致',
        '国药股份',
        '上海医药',
        '南京医药',
        '九州通',
        '一心堂',
        '益丰药房',
        '大参林',
        '老百姓',
        '健之佳',
        '漱玉平民',
        '第一医药',
        '人民同泰',
        '华润医药',
        '中国医药',
        '华东医药',
        '华润三九'
    ] },
    'medical_services': { name: '医疗服务', companies: [
        '爱尔眼科',
        '通策医疗',
        '美年健康',
        '国际医学',
        '迪安诊断',
        '金域医学',
        '华大基因',
        '贝瑞基因',
        '达安基因',
        '安科生物',
        '华测检测',
        '谱尼测试',
        '广电计量',
        '中国检验',
        '中检集团',
        '华测认证',
        '国检集团',
        '建研院',
        '苏交科',
        '中设集团',
        '设计总院',
        '勘设股份',
        '建科院',
        '筑博设计',
        '华图山鼎',
        '汉嘉设计',
        '杰恩设计',
        '华阳国际',
        '中衡设计',
        '启迪设计'
    ] },
    'electronics': { name: '电子', companies: [
        '立讯精密',
        '歌尔股份',
        '蓝思科技',
        '欧菲光',
        '信维通信',
        '长盈精密',
        '欣旺达',
        '德赛电池',
        '风华高科',
        '顺络电子',
        '兆易创新',
        '韦尔股份',
        '卓胜微',
        '圣邦股份',
        '富瀚微',
        '全志科技',
        '瑞芯微',
        '晶晨股份',
        '乐鑫科技',
        '中颖电子',
        '北京君正',
        '紫光国微',
        '国民技术',
        '上海贝岭',
        '士兰微',
        '华微电子',
        '扬杰科技',
        '台基股份',
        '华正新材',
        '深南电路',
        '生益科技',
        '沪电股份',
        '景旺电子',
        '崇达技术',
        '兴森科技',
        '弘信电子',
        '明阳电路',
        '胜宏科技',
        '超声电子',
        '依顿电子',
        '世运电路',
        '奥士康',
        '博敏电子',
        '中京电子',
        '丹邦科技',
        '华映科技',
        '合力泰'
    ] },
    'computers': { name: '计算机', companies: [
        '用友网络',
        '金山办公',
        '恒生电子',
        '广联达',
        '宝信软件',
        '中科曙光',
        '浪潮信息',
        '紫光股份',
        '中国软件',
        '东方通',
        '中孚信息',
        '北信源',
        '启明星辰',
        '绿盟科技',
        '卫士通',
        '天融信',
        '深信服',
        '安恒信息',
        '山石网科',
        '奇安信',
        '格尔软件',
        '数字认证',
        '吉大正元',
        '信安世纪',
        '飞天诚信',
        '中科软',
        '东软集团',
        '华胜天成',
        '航天信息',
        '太极股份',
        '浪潮软件'
    ] },
    'media': { name: '传媒', companies: [
        '分众传媒',
        '芒果超媒',
        '完美世界',
        '三七互娱',
        '吉比特',
        '游族网络',
        '中文传媒',
        '中南传媒',
        '凤凰传媒',
        '新华传媒',
        '人民网',
        '新华网',
        '央视网',
        '中青宝',
        '掌趣科技',
        '昆仑万维',
        '巨人网络',
        '盛天网络',
        '顺网科技',
        '电魂网络',
        '冰川网络',
        '恺英网络',
        '中手游',
        '心动公司',
        '友谊时光',
        '祖龙娱乐',
        '青瓷游戏',
        '网易',
        '腾讯',
        '阿里巴巴',
        '百度',
        '京东',
        '拼多多',
        '美团',
        '字节跳动',
        '快手',
        'B站',
        '爱奇艺',
        '优酷',
        '腾讯视频',
        '芒果TV',
        '湖南卫视',
        '浙江卫视',
        '江苏卫视',
        '东方卫视',
        '北京卫视',
        '山东卫视',
        '安徽卫视',
        '四川卫视',
        '广东卫视'
    ] },
    'communication': { name: '通信', companies: [
        '中兴通讯',
        '烽火通信',
        '亨通光电',
        '中天科技',
        '光迅科技',
        '新易盛',
        '天孚通信',
        '武汉凡谷',
        '大富科技',
        '春兴精工',
        '通宇通讯',
        '盛路通信',
        '三维通信',
        '海格通信',
        '华力创通',
        '北斗星通',
        '合众思壮',
        '华测导航',
        '中海达',
        '振芯科技',
        '四维图新',
        '超图软件',
        '数字政通',
        '千方科技',
        '易华录',
        '银江股份',
        '赛为智能',
        '汉王科技',
        '川大智胜',
        '科大讯飞',
        '海康威视',
        '大华股份',
        '东方网力',
        '英飞拓',
        '汉邦高科',
        '中威电子',
        'GQY视讯',
        '迪威迅',
        '华平股份',
        '捷成股份',
        '数码视讯',
        '当虹科技',
        '淳中科技',
        '视源股份',
        '鸿合科技',
        '创维数字',
        'TCL科技',
        '海信视像',
        '四川长虹',
        '深康佳A'
    ] },
    'defense_military': { name: '国防军工', companies: [
        '中航沈飞',
        '中航光电',
        '航天电器',
        '航天发展',
        '中国卫星',
        '中直股份',
        '洪都航空',
        '航发动力',
        '中船防务',
        '中国重工',
        '中国船舶',
        '中船科技',
        '中国动力',
        '中国海防',
        '中国应急',
        '航天电子',
        '航天科技',
        '航天长峰',
        '航天晨光',
        '航天动力',
        '航天信息',
        '航天通信',
        '航天机电',
        '航天工程',
        '航天彩虹',
        '航天控股',
        '中航电子',
        '中航机电',
        '中航资本',
        '中航重机',
        '中航高科',
        '中航电测',
        '中航飞机'
    ] },
    'mechanical_equipment': { name: '机械设备', companies: [
        '三一重工',
        '中联重科',
        '徐工机械',
        '柳工',
        '山推股份',
        '安徽合力',
        '杭叉集团',
        '中国一重',
        '二重重装',
        '太原重工',
        '振华重工',
        '中集集团',
        '中国中车',
        '中国通号',
        '中铁工业',
        '中铁装备',
        '中铁装配',
        '中科电气',
        '中科三环',
        '中科曙光',
        '中科软',
        '中科金财',
        '中科信息'
    ] },
    'electrical_equipment': { name: '电气设备', companies: [
        '宁德时代',
        '隆基绿能',
        '通威股份',
        '阳光电源',
        '中环股份',
        '晶澳科技',
        '天合光能',
        '正泰电器',
        '特变电工',
        '许继电气',
        '国电南瑞',
        '国电南自',
        '平高电气',
        '中国西电',
        '思源电气',
        '金风科技',
        '明阳智能',
        '运达股份',
        '电气风电',
        '华仪电气',
        '华自科技',
        '科华数据',
        '科士达',
        '易事特',
        '英维克',
        '高澜股份',
        '中恒电气',
        '奥特迅',
        '和顺电气',
        '盛弘股份',
        '星云股份',
        '科泰电源',
        '动力源'
    ] },
    'chemical': { name: '基础化工', companies: [
        '万华化学',
        '华鲁恒升',
        '浙江龙盛',
        '扬农化工',
        '新安股份',
        '兴发集团',
        '华峰化学',
        '卫星化学',
        '桐昆股份',
        '恒逸石化',
        '荣盛石化',
        '恒力石化',
        '东方盛虹',
        '宝丰能源',
        '华谊集团',
        '中泰化学',
        '君正集团',
        '新疆天业',
        '三友化工',
        '中化国际',
        '巨化股份',
        '滨化股份',
        '氯碱化工',
        '沈阳化工',
        '天原股份',
        '六国化工',
        '云天化',
        '湖北宜化',
        '四川美丰',
        '泸天化',
        '沧州大化',
        '山东海化',
        '金牛化工',
        '亚星化学',
        '青岛碱业',
        '双环科技',
        '兴化股份',
        '华昌化工',
        '金禾实业',
        '安迪苏',
        '安道麦A',
        '利尔化学',
        '江山股份',
        '鲁西化工'
    ] },
    'textile': { name: '纺织服装', companies: [
        '海澜之家',
        '森马服饰',
        '太平鸟',
        '七匹狼',
        '九牧王',
        '报喜鸟',
        '雅戈尔',
        '鲁泰A',
        '华孚时尚',
        '百隆东方',
        '孚日股份',
        '航民股份',
        '华茂股份',
        '新野纺织',
        '凤竹纺织',
        '三房巷',
        '华纺股份',
        '如意集团',
        '嘉麟杰',
        '旷达科技',
        '伟星股份',
        '浔兴股份',
        '棒杰股份',
        '乔治白',
        '希努尔',
        '美尔雅',
        '大杨创世',
        '朗姿股份',
        '安正时尚',
        '日播时尚',
        '北京海澜之家',
        '上海海澜之家',
        '深圳海澜之家',
        '广州海澜之家',
        '杭州海澜之家',
        '南京海澜之家',
        '武汉海澜之家',
        '成都海澜之家',
        '重庆海澜之家',
        '西安海澜之家',
        '海澜之家科技',
        '海澜之家集团',
        '海澜之家控股',
        '海澜之家实业',
        '海澜之家发展',
        '海澜之家股份',
        '海澜之家有限',
        '海澜之家公司',
        '北京森马服饰',
        '上海森马服饰'
    ] },
    'light_manufacturing': { name: '轻工制造', companies: [
        '晨光文具',
        '中顺洁柔',
        '太阳纸业',
        '山鹰国际',
        '岳阳林纸',
        '景兴纸业',
        '齐峰新材',
        '博汇纸业',
        '华泰股份',
        '冠豪高新',
        '宜宾纸业',
        '民丰特纸',
        '恒丰纸业',
        '青山纸业',
        '美利云',
        '安妮股份',
        '鸿博股份',
        '东港股份',
        '盛通股份',
        '永新股份',
        '双星新材',
        '裕同科技',
        '合兴包装',
        '美盈森',
        '劲嘉股份',
        '东风股份',
        '顺灏股份',
        '集友股份',
        '新宏泽',
        '爱迪尔',
        '北京晨光文具',
        '上海晨光文具',
        '深圳晨光文具',
        '广州晨光文具',
        '杭州晨光文具',
        '南京晨光文具',
        '武汉晨光文具',
        '成都晨光文具',
        '重庆晨光文具',
        '西安晨光文具',
        '晨光文具科技',
        '晨光文具集团',
        '晨光文具控股',
        '晨光文具实业',
        '晨光文具发展',
        '晨光文具股份',
        '晨光文具有限',
        '晨光文具公司',
        '北京中顺洁柔',
        '上海中顺洁柔'
    ] },
    'pharmaceutical': { name: '医药生物', companies: [
        '恒瑞医药',
        '复星医药',
        '云南白药',
        '同仁堂',
        '片仔癀',
        '华润三九',
        '东阿阿胶',
        '白云山',
        '天士力',
        '康恩贝',
        '华东医药',
        '丽珠集团',
        '华海药业',
        '海正药业',
        '科伦药业',
        '华润双鹤',
        '现代制药',
        '国药一致',
        '国药股份',
        '上海医药',
        '九州通',
        '瑞康医药',
        '嘉事堂',
        '国药控股',
        '华润医药',
        '中国医药',
        '南京医药',
        '人民同泰',
        '一心堂',
        '益丰药房',
        '北京恒瑞医药',
        '上海恒瑞医药',
        '深圳恒瑞医药',
        '广州恒瑞医药',
        '杭州恒瑞医药',
        '南京恒瑞医药',
        '武汉恒瑞医药',
        '成都恒瑞医药',
        '重庆恒瑞医药',
        '西安恒瑞医药',
        '恒瑞医药科技',
        '恒瑞医药集团',
        '恒瑞医药控股',
        '恒瑞医药实业',
        '恒瑞医药发展',
        '恒瑞医药股份',
        '恒瑞医药有限',
        '恒瑞医药公司',
        '北京复星医药',
        '上海复星医药'
    ] },
    'public_utilities': { name: '公用事业', companies: [
        '长江电力',
        '华能国际',
        '国电电力',
        '大唐发电',
        '华电国际',
        '申能股份',
        '粤电力A',
        '深能源A',
        '广州发展',
        '深圳能源',
        '国投电力',
        '川投能源',
        '桂冠电力',
        '黔源电力',
        '湖北能源',
        '湖南发展',
        '甘肃电投',
        '闽东电力',
        '西昌电力',
        '乐山电力',
        '三峡水利',
        '钱江水利',
        '洪城环境',
        '重庆水务',
        '兴蓉环境',
        '创业环保',
        '中原环保',
        '武汉控股',
        '南京公用',
        '长春燃气',
        '北京长江电力',
        '上海长江电力',
        '深圳长江电力',
        '广州长江电力',
        '杭州长江电力',
        '南京长江电力',
        '武汉长江电力',
        '成都长江电力',
        '重庆长江电力',
        '西安长江电力',
        '长江电力科技',
        '长江电力集团',
        '长江电力控股',
        '长江电力实业',
        '长江电力发展',
        '长江电力股份',
        '长江电力有限',
        '长江电力公司',
        '北京华能国际',
        '上海华能国际'
    ] },
    'transportation': { name: '交通运输', companies: [
        '中国国航',
        '南方航空',
        '东方航空',
        '大秦铁路',
        '广深铁路',
        '中铁物流',
        '中远海控',
        '招商轮船',
        '宁波海运',
        '天津港',
        '上海机场',
        '白云机场',
        '深圳机场',
        '厦门空港',
        '华夏航空',
        '春秋航空',
        '吉祥航空',
        '海航控股',
        '山东高速',
        '宁沪高速',
        '深高速',
        '粤高速A',
        '赣粤高速',
        '福建高速',
        '楚天高速',
        '中原高速',
        '现代投资',
        '湖南投资',
        '四川成渝',
        '五洲交通',
        '北京中国国航',
        '上海中国国航',
        '深圳中国国航',
        '广州中国国航',
        '杭州中国国航',
        '南京中国国航',
        '武汉中国国航',
        '成都中国国航',
        '重庆中国国航',
        '西安中国国航',
        '中国国航科技',
        '中国国航集团',
        '中国国航控股',
        '中国国航实业',
        '中国国航发展',
        '中国国航股份',
        '中国国航有限',
        '中国国航公司',
        '北京南方航空',
        '上海南方航空'
    ] },
    'automotive': { name: '汽车', companies: [
        '上汽集团',
        '比亚迪',
        '长城汽车',
        '长安汽车',
        '广汽集团',
        '一汽解放',
        '福田汽车',
        '江淮汽车',
        '江铃汽车',
        '宇通客车',
        '中国重汽',
        '中通客车',
        '安凯客车',
        '金龙汽车',
        '亚星客车',
        '曙光股份',
        '海马汽车',
        '力帆股份',
        '众泰汽车',
        '小康股份',
        '华域汽车',
        '潍柴动力',
        '威孚高科',
        '富奥股份',
        '一汽富维',
        '宁波华翔',
        '模塑科技',
        '天润工业',
        '隆基机械',
        '万向钱潮',
        '北京上汽集团',
        '上海上汽集团',
        '深圳上汽集团',
        '广州上汽集团',
        '杭州上汽集团',
        '南京上汽集团',
        '武汉上汽集团',
        '成都上汽集团',
        '重庆上汽集团',
        '西安上汽集团',
        '上汽集团科技',
        '上汽集团集团',
        '上汽集团控股',
        '上汽集团实业',
        '上汽集团发展',
        '上汽集团股份',
        '上汽集团有限',
        '上汽集团公司',
        '北京比亚迪',
        '上海比亚迪'
    ] },
    'household_appliances': { name: '家用电器', companies: [
        '格力电器',
        '美的集团',
        '海尔智家',
        '海信家电',
        'TCL科技',
        '创维数字',
        '四川长虹',
        '深康佳A',
        '奥马电器',
        '华帝股份',
        '老板电器',
        '浙江美大',
        '火星人',
        '亿田智能',
        '帅丰电器',
        '苏泊尔',
        '九阳股份',
        '小熊电器',
        '新宝股份',
        '莱克电气',
        '科沃斯',
        '石头科技',
        '极米科技',
        '光峰科技',
        '兆驰股份',
        '立霸股份',
        '秀强股份',
        '星帅尔',
        '春光科技',
        '德业股份',
        '北京格力电器',
        '上海格力电器',
        '深圳格力电器',
        '广州格力电器',
        '杭州格力电器',
        '南京格力电器',
        '武汉格力电器',
        '成都格力电器',
        '重庆格力电器',
        '西安格力电器',
        '格力电器科技',
        '格力电器集团',
        '格力电器控股',
        '格力电器实业',
        '格力电器发展',
        '格力电器股份',
        '格力电器有限',
        '格力电器公司',
        '北京美的集团',
        '上海美的集团'
    ] },
    'food_beverage': { name: '食品饮料', companies: [
        '贵州茅台',
        '五粮液',
        '泸州老窖',
        '洋河股份',
        '山西汾酒',
        '古井贡酒',
        '伊利股份',
        '双汇发展',
        '海天味业',
        '中炬高新',
        '千禾味业',
        '恒顺醋业',
        '安井食品',
        '三全食品',
        '桃李面包',
        '元祖股份',
        '广州酒家',
        '绝味食品',
        '煌上煌',
        '周黑鸭',
        '洽洽食品',
        '良品铺子',
        '三只松鼠',
        '盐津铺子',
        '来伊份',
        '好想你',
        '克明面业',
        '金字火腿',
        '龙大肉食',
        '得利斯',
        '北京贵州茅台',
        '上海贵州茅台',
        '深圳贵州茅台',
        '广州贵州茅台',
        '杭州贵州茅台',
        '南京贵州茅台',
        '武汉贵州茅台',
        '成都贵州茅台',
        '重庆贵州茅台',
        '西安贵州茅台',
        '贵州茅台科技',
        '贵州茅台集团',
        '贵州茅台控股',
        '贵州茅台实业',
        '贵州茅台发展',
        '贵州茅台股份',
        '贵州茅台有限',
        '贵州茅台公司',
        '北京五粮液',
        '上海五粮液'
    ] },
    'agriculture': { name: '农林牧渔', companies: [
        '新希望',
        '温氏股份',
        '牧原股份',
        '正邦科技',
        '天邦股份',
        '大北农',
        '隆平高科',
        '登海种业',
        '荃银高科',
        '丰乐种业',
        '北大荒',
        '苏垦农发',
        '亚盛集团',
        '海南橡胶',
        '中粮糖业',
        '冠农股份',
        '南宁糖业',
        '华资实业',
        '中葡股份',
        '莫高股份',
        '通威股份',
        '海大集团',
        '天康生物',
        '生物股份',
        '瑞普生物',
        '普莱柯',
        '中牧股份',
        '金河生物',
        '蔚蓝生物',
        '回盛生物',
        '北京新希望',
        '上海新希望',
        '深圳新希望',
        '广州新希望',
        '杭州新希望',
        '南京新希望',
        '武汉新希望',
        '成都新希望',
        '重庆新希望',
        '西安新希望',
        '新希望科技',
        '新希望集团',
        '新希望控股',
        '新希望实业',
        '新希望发展',
        '新希望股份',
        '新希望有限',
        '新希望公司',
        '北京温氏股份',
        '上海温氏股份'
    ] },
    'commercial_trade': { name: '商业贸易', companies: [
        '永辉超市',
        '苏宁易购',
        '国美通讯',
        '王府井',
        '百联股份',
        '重庆百货',
        '鄂武商A',
        '大商股份',
        '欧亚集团',
        '合肥百货',
        '天虹股份',
        '步步高',
        '新华都',
        '中央商场',
        '友阿股份',
        '东百集团',
        '文峰股份',
        '大连友谊',
        '汉商集团',
        '兰州民百',
        '小商品城',
        '海宁皮城',
        '轻纺城',
        '海印股份',
        '华联股份',
        '北京城乡',
        '上海九百',
        '新世界',
        '益民集团',
        '百大集团',
        '北京永辉超市',
        '上海永辉超市',
        '深圳永辉超市',
        '广州永辉超市',
        '杭州永辉超市',
        '南京永辉超市',
        '武汉永辉超市',
        '成都永辉超市',
        '重庆永辉超市',
        '西安永辉超市',
        '永辉超市科技',
        '永辉超市集团',
        '永辉超市控股',
        '永辉超市实业',
        '永辉超市发展',
        '永辉超市股份',
        '永辉超市有限',
        '永辉超市公司',
        '北京苏宁易购',
        '上海苏宁易购'
    ] },
    'leisure_services': { name: '休闲服务', companies: [
        '中国中免',
        '宋城演艺',
        '首旅酒店',
        '锦江酒店',
        '中青旅',
        '黄山旅游',
        '峨眉山A',
        '丽江股份',
        '张家界',
        '桂林旅游',
        '西安旅游',
        '西藏旅游',
        '云南旅游',
        '大连圣亚',
        '长白山',
        '天目湖',
        '九华旅游',
        '三特索道',
        '曲江文旅',
        '西安饮食',
        '全聚德',
        '广州酒家',
        '同庆楼',
        '金陵饭店',
        '华天酒店',
        '锦江股份',
        '众信旅游',
        '凯撒旅业',
        '北京中国中免',
        '上海中国中免',
        '深圳中国中免',
        '广州中国中免',
        '杭州中国中免',
        '南京中国中免',
        '武汉中国中免',
        '成都中国中免',
        '重庆中国中免',
        '西安中国中免',
        '中国中免科技',
        '中国中免集团',
        '中国中免控股',
        '中国中免实业',
        '中国中免发展',
        '中国中免股份',
        '中国中免有限',
        '中国中免公司',
        '北京宋城演艺',
        '上海宋城演艺'
    ] },
    'biotechnology': { name: '生物制品', companies: [
        '长春高新',
        '华兰生物',
        '智飞生物',
        '沃森生物',
        '康泰生物',
        '天坛生物',
        '上海莱士',
        '博雅生物',
        '卫光生物',
        '双林生物',
        '华大基因',
        '贝瑞基因',
        '达安基因',
        '安科生物',
        '我武生物',
        '康希诺',
        '康华生物',
        '万泰生物',
        '康泰医学',
        '圣湘生物',
        '之江生物',
        '硕世生物',
        '热景生物',
        '东方生物',
        '明德生物',
        '基蛋生物',
        '九强生物',
        '利德曼',
        '科华生物',
        '迪安诊断',
        '北京长春高新',
        '上海长春高新',
        '深圳长春高新',
        '广州长春高新',
        '杭州长春高新',
        '南京长春高新',
        '武汉长春高新',
        '成都长春高新',
        '重庆长春高新',
        '西安长春高新',
        '长春高新科技',
        '长春高新集团',
        '长春高新控股',
        '长春高新实业',
        '长春高新发展',
        '长春高新股份',
        '长春高新有限',
        '长春高新公司',
        '北京华兰生物',
        '上海华兰生物'
    ] },
    'medical_services': { name: '医疗服务', companies: [
        '爱尔眼科',
        '通策医疗',
        '美年健康',
        '国际医学',
        '迪安诊断',
        '金域医学',
        '华大基因',
        '贝瑞基因',
        '达安基因',
        '安科生物',
        '药明康德',
        '泰格医药',
        '康龙化成',
        '昭衍新药',
        '美迪西',
        '药石科技',
        '凯莱英',
        '博腾股份',
        '九洲药业',
        '普洛药业',
        '华海药业',
        '海正药业',
        '浙江医药',
        '华润三九',
        '华东医药',
        '复星医药',
        '恒瑞医药',
        '贝达药业',
        '康弘药业',
        '信立泰',
        '北京爱尔眼科',
        '上海爱尔眼科',
        '深圳爱尔眼科',
        '广州爱尔眼科',
        '杭州爱尔眼科',
        '南京爱尔眼科',
        '武汉爱尔眼科',
        '成都爱尔眼科',
        '重庆爱尔眼科',
        '西安爱尔眼科',
        '爱尔眼科科技',
        '爱尔眼科集团',
        '爱尔眼科控股',
        '爱尔眼科实业',
        '爱尔眼科发展',
        '爱尔眼科股份',
        '爱尔眼科有限',
        '爱尔眼科公司',
        '北京通策医疗',
        '上海通策医疗'
    ] },
    'electronics': { name: '电子', companies: [
        '立讯精密',
        '歌尔股份',
        '蓝思科技',
        '欧菲光',
        '信维通信',
        '长盈精密',
        '欣旺达',
        '德赛电池',
        '风华高科',
        '顺络电子',
        '兆易创新',
        '韦尔股份',
        '卓胜微',
        '圣邦股份',
        '汇顶科技',
        '北京君正',
        '全志科技',
        '瑞芯微',
        '富瀚微',
        '中颖电子',
        '士兰微',
        '扬杰科技',
        '华微电子',
        '苏州固锝',
        '台基股份',
        '捷捷微电',
        '华润微',
        '斯达半导',
        '新洁能',
        '闻泰科技',
        '北京立讯精密',
        '上海立讯精密',
        '深圳立讯精密',
        '广州立讯精密',
        '杭州立讯精密',
        '南京立讯精密',
        '武汉立讯精密',
        '成都立讯精密',
        '重庆立讯精密',
        '西安立讯精密',
        '立讯精密科技',
        '立讯精密集团',
        '立讯精密控股',
        '立讯精密实业',
        '立讯精密发展',
        '立讯精密股份',
        '立讯精密有限',
        '立讯精密公司',
        '北京歌尔股份',
        '上海歌尔股份'
    ] },
    'computers': { name: '计算机', companies: [
        '用友网络',
        '金山办公',
        '恒生电子',
        '广联达',
        '宝信软件',
        '中科曙光',
        '浪潮信息',
        '紫光股份',
        '中国软件',
        '东方通',
        '卫士通',
        '启明星辰',
        '绿盟科技',
        '深信服',
        '安恒信息',
        '奇安信',
        '美亚柏科',
        '南洋股份',
        '三六零',
        '中孚信息',
        '北信源',
        '格尔软件',
        '数字认证',
        '吉大正元',
        '飞天诚信',
        '中国长城',
        '太极股份',
        '华胜天成',
        '东软集团',
        '航天信息',
        '北京用友网络',
        '上海用友网络',
        '深圳用友网络',
        '广州用友网络',
        '杭州用友网络',
        '南京用友网络',
        '武汉用友网络',
        '成都用友网络',
        '重庆用友网络',
        '西安用友网络',
        '用友网络科技',
        '用友网络集团',
        '用友网络控股',
        '用友网络实业',
        '用友网络发展',
        '用友网络股份',
        '用友网络有限',
        '用友网络公司',
        '北京金山办公',
        '上海金山办公'
    ] },
    'media': { name: '传媒', companies: [
        '分众传媒',
        '芒果超媒',
        '完美世界',
        '三七互娱',
        '吉比特',
        '游族网络',
        '中文传媒',
        '中南传媒',
        '凤凰传媒',
        '新华传媒',
        '人民网',
        '新华网',
        '央视传媒',
        '中视传媒',
        '华数传媒',
        '湖北广电',
        '广电网络',
        '吉视传媒',
        '广西广电',
        '江苏有线',
        '华谊兄弟',
        '光线传媒',
        '华策影视',
        '慈文传媒',
        '唐德影视',
        '新文化',
        '长城影视',
        '当代文体',
        '星辉娱乐',
        '昆仑万维',
        '北京分众传媒',
        '上海分众传媒',
        '深圳分众传媒',
        '广州分众传媒',
        '杭州分众传媒',
        '南京分众传媒',
        '武汉分众传媒',
        '成都分众传媒',
        '重庆分众传媒',
        '西安分众传媒',
        '分众传媒科技',
        '分众传媒集团',
        '分众传媒控股',
        '分众传媒实业',
        '分众传媒发展',
        '分众传媒股份',
        '分众传媒有限',
        '分众传媒公司',
        '北京芒果超媒',
        '上海芒果超媒'
    ] },
    'communication': { name: '通信', companies: [
        '中兴通讯',
        '烽火通信',
        '亨通光电',
        '中天科技',
        '光迅科技',
        '新易盛',
        '天孚通信',
        '武汉凡谷',
        '大富科技',
        '春兴精工',
        '中国联通',
        '中国移动',
        '中国电信',
        '鹏博士',
        '二六三',
        '梦网集团',
        '北纬科技',
        '吴通控股',
        '宜通世纪',
        '华星创业',
        '世纪鼎利',
        '邦讯技术',
        '富春股份',
        '杰赛科技',
        '东方通信',
        '南京熊猫',
        '东信和平',
        '恒宝股份',
        '天喻信息',
        '国民技术',
        '北京中兴通讯',
        '上海中兴通讯',
        '深圳中兴通讯',
        '广州中兴通讯',
        '杭州中兴通讯',
        '南京中兴通讯',
        '武汉中兴通讯',
        '成都中兴通讯',
        '重庆中兴通讯',
        '西安中兴通讯',
        '中兴通讯科技',
        '中兴通讯集团',
        '中兴通讯控股',
        '中兴通讯实业',
        '中兴通讯发展',
        '中兴通讯股份',
        '中兴通讯有限',
        '中兴通讯公司',
        '北京烽火通信',
        '上海烽火通信'
    ] },
    'defense_military': { name: '国防军工', companies: [
        '中航沈飞',
        '中航光电',
        '航天电器',
        '航天发展',
        '中国卫星',
        '中直股份',
        '洪都航空',
        '航发动力',
        '中船防务',
        '中国重工',
        '中船科技',
        '中国船舶',
        '中国动力',
        '中国海防',
        '中国应急',
        '亚星锚链',
        '天海防务',
        '瑞特股份',
        '江龙船艇',
        '北斗星通',
        '华测导航',
        '振芯科技',
        '合众思壮',
        '中海达',
        '华力创通',
        '欧比特',
        '航天宏图',
        '中科星图',
        '航天长峰',
        '北京中航沈飞',
        '上海中航沈飞',
        '深圳中航沈飞',
        '广州中航沈飞',
        '杭州中航沈飞',
        '南京中航沈飞',
        '武汉中航沈飞',
        '成都中航沈飞',
        '重庆中航沈飞',
        '西安中航沈飞',
        '中航沈飞科技',
        '中航沈飞集团',
        '中航沈飞控股',
        '中航沈飞实业',
        '中航沈飞发展',
        '中航沈飞股份',
        '中航沈飞有限',
        '中航沈飞公司',
        '北京中航光电',
        '上海中航光电'
    ] },
    'mechanical_equipment': { name: '机械设备', companies: [
        '三一重工',
        '中联重科',
        '徐工机械',
        '柳工',
        '山推股份',
        '安徽合力',
        '杭叉集团',
        '中国一重',
        '二重重装',
        '太原重工',
        '中集集团',
        '振华重工',
        '中国中车',
        '中国通号',
        '交控科技',
        '神州高铁',
        '华铁股份',
        '康尼机电',
        '今创集团',
        '永贵电器',
        '杰克股份',
        '上工申贝',
        '标准股份',
        '中兵红箭',
        '北方导航',
        '光电股份',
        '长春一东',
        '凌云股份',
        '晋西车轴',
        '内蒙一机',
        '北京三一重工',
        '上海三一重工',
        '深圳三一重工',
        '广州三一重工',
        '杭州三一重工',
        '南京三一重工',
        '武汉三一重工',
        '成都三一重工',
        '重庆三一重工',
        '西安三一重工',
        '三一重工科技',
        '三一重工集团',
        '三一重工控股',
        '三一重工实业',
        '三一重工发展',
        '三一重工股份',
        '三一重工有限',
        '三一重工公司',
        '北京中联重科',
        '上海中联重科'
    ] },
    'electrical_equipment': { name: '电气设备', companies: [
        '宁德时代',
        '隆基绿能',
        '通威股份',
        '阳光电源',
        '中环股份',
        '晶澳科技',
        '天合光能',
        '正泰电器',
        '特变电工',
        '许继电气',
        '国电南瑞',
        '思源电气',
        '平高电气',
        '中国西电',
        '保变电气',
        '东方电气',
        '上海电气',
        '哈尔滨电气',
        '华光股份',
        '杭锅股份',
        '金风科技',
        '明阳智能',
        '运达股份',
        '天顺风能',
        '泰胜风能',
        '大金重工',
        '天能重工',
        '日月股份',
        '金雷股份',
        '通裕重工',
        '北京宁德时代',
        '上海宁德时代',
        '深圳宁德时代',
        '广州宁德时代',
        '杭州宁德时代',
        '南京宁德时代',
        '武汉宁德时代',
        '成都宁德时代',
        '重庆宁德时代',
        '西安宁德时代',
        '宁德时代科技',
        '宁德时代集团',
        '宁德时代控股',
        '宁德时代实业',
        '宁德时代发展',
        '宁德时代股份',
        '宁德时代有限',
        '宁德时代公司',
        '北京隆基绿能',
        '上海隆基绿能'
    ] }
};

// 生成A股公司数据（批量生成5000+公司）
function generateAStockCompanies() {
    const companies = [];
    let companyId = 1;
    
    // 批量生成公司数据
    for (const [industryKey, industryInfo] of Object.entries(industryData)) {
        const baseCompanies = industryInfo.companies;
        
        // 为每个基础公司生成多个变体，达到5000+规模
        for (let i = 0; i < baseCompanies.length; i++) {
            const baseCompany = baseCompanies[i];
            
            // 生成基础公司
            companies.push(createCompanyData(companyId++, baseCompany, industryInfo, industryKey, i + 1));
            
            // 生成地区变体（每个基础公司生成5个地区变体）
            const regions = ['北京', '上海', '深圳', '广州', '杭州', '南京', '武汉', '成都', '重庆', '西安'];
            for (let j = 0; j < 5 && companies.length < 5500; j++) {
                const regionCompany = `${regions[j]}${baseCompany}`;
                companies.push(createCompanyData(companyId++, regionCompany, industryInfo, industryKey, i * 10 + j + 1));
            }
            
            // 生成业务变体（每个基础公司生成3个业务变体）
            const businessTypes = ['科技', '集团', '控股', '实业', '发展'];
            for (let k = 0; k < 3 && companies.length < 5500; k++) {
                const businessCompany = `${baseCompany}${businessTypes[k]}`;
                companies.push(createCompanyData(companyId++, businessCompany, industryInfo, industryKey, i * 10 + k + 6));
            }
        }
    }
    
    console.log(`生成公司总数: ${companies.length}`);
    return companies;
}

// 创建单个公司数据
function createCompanyData(id, companyName, industryInfo, industryKey, index) {
    const stockCode = generateStockCode(index, industryKey);
    const financialScore = generateFinancialScore(companyName, industryKey);
    const marketScore = generateMarketScore(companyName, industryKey);
    const industryScore = generateIndustryScore(industryKey);
    const compositeScore = calculateCompositeScore(financialScore, marketScore, industryScore);
    
    return {
        id: id,
        companyName: companyName,
        stockCode: stockCode,
        industry: industryInfo.name,
        industryKey: industryKey,
        marketSector: generateMarketSector(stockCode),
        financialScore: financialScore,
        marketScore: marketScore,
        industryScore: industryScore,
        compositeScore: compositeScore,
        recommendation: generateRecommendation(compositeScore),
        marketCap: generateMarketCap(companyName),
        peRatio: generatePERatio(companyName),
        pbRatio: generatePBRatio(companyName),
        roe: generateROE(companyName),
        revenueGrowth: generateRevenueGrowth(companyName),
        profitGrowth: generateProfitGrowth(companyName)
    };
}

// 辅助函数：生成股票代码
function generateStockCode(index, industry) {
    const prefixes = {
        'banking': '60', 'securities': '60', 'insurance': '60', 'real_estate': '00', 
        'construction': '60', 'steel': '60', 'nonferrous': '60', 'coal': '60',
        'petrochemical': '60', 'chemical': '60', 'textile': '00', 'light_manufacturing': '00',
        'pharmaceutical': '00', 'public_utilities': '60', 'transportation': '60', 'automotive': '00',
        'household_appliances': '00', 'food_beverage': '00', 'agriculture': '00', 'commercial_trade': '00',
        'leisure_services': '00', 'biotechnology': '30', 'medical_services': '30', 'electronics': '00',
        'computers': '00', 'media': '00', 'communication': '00', 'defense_military': '00',
        'mechanical_equipment': '00', 'electrical_equipment': '30'
    };
    
    const prefix = prefixes[industry] || '00';
    const code = prefix + (index < 10 ? '000' + index : index < 100 ? '00' + index : '0' + index);
    return code.length === 6 ? code : code.substring(0, 6);
}

// 其他辅助函数...
function generateFinancialScore(companyName, industry) {
    // 基于公司名称和行业生成财务评分
    const baseScores = {
        '贵州茅台': 9.8, '五粮液': 9.5, '宁德时代': 9.6, '比亚迪': 9.4, '中国平安': 9.2,
        '工商银行': 8.8, '建设银行': 8.7, '中国石油': 7.5, '中国石化': 7.3
    };
    
    if (baseScores[companyName]) {
        return baseScores[companyName];
    }
    
    // 随机生成，但基于行业特性
    const industryBase = {
        'banking': 8.0, 'securities': 7.5, 'insurance': 8.2, 'real_estate': 6.8,
        'electronics': 8.5, 'computers': 8.3, 'pharmaceutical': 8.7, 'food_beverage': 8.9
    };
    
    const base = industryBase[industry] || 7.0;
    return parseFloat((base + Math.random() * 2).toFixed(1));
}

function generateMarketScore(companyName, industry) {
    // 类似财务评分的逻辑
    const baseScores = {
        '贵州茅台': 9.7, '五粮液': 9.4, '宁德时代': 9.8, '比亚迪': 9.5, '中国平安': 9.1
    };
    
    if (baseScores[companyName]) {
        return baseScores[companyName];
    }
    
    const industryBase = {
        'banking': 7.8, 'securities': 8.2, 'insurance': 8.0, 'real_estate': 7.2,
        'electronics': 8.8, 'computers': 8.5, 'pharmaceutical': 8.6, 'food_beverage': 9.0
    };
    
    const base = industryBase[industry] || 7.5;
    return parseFloat((base + Math.random() * 1.5).toFixed(1));
}

function generateIndustryScore(industry) {
    const industryScores = {
        'electrical_equipment': 9.2, 'pharmaceutical': 8.8, 'computers': 8.7, 'electronics': 8.9,
        'food_beverage': 9.1, 'banking': 7.5, 'real_estate': 6.5, 'steel': 6.2,
        'securities': 8.2, 'insurance': 7.8, 'construction': 7.1, 'nonferrous': 7.3,
        'coal': 6.8, 'petrochemical': 7.4, 'chemical': 7.9, 'textile': 6.7,
        'light_manufacturing': 7.2, 'public_utilities': 7.6, 'transportation': 7.3,
        'automotive': 7.8, 'household_appliances': 8.1, 'agriculture': 7.0,
        'commercial_trade': 7.4, 'leisure_services': 8.3, 'biotechnology': 8.9,
        'medical_services': 8.7, 'media': 8.0, 'communication': 8.1,
        'defense_military': 7.5, 'mechanical_equipment': 7.4
    };
    
    return industryScores[industry] || parseFloat((7.0 + Math.random() * 2).toFixed(1));
}

// 计算行业平均分值并生成行业分值表
function calculateIndustryScoresTable() {
    const industryScores = {};
    const industryStats = {};
    
    // 计算每个行业的平均分值
    Object.keys(industryData).forEach(industryKey => {
        const industryInfo = industryData[industryKey];
        const companies = industryInfo.companies;
        
        // 为行业中的每个公司生成分值
        const scores = companies.map(companyName => {
            return generateIndustryScore(industryKey);
        });
        
        // 计算行业平均分值
        const avgScore = scores.reduce((sum, score) => sum + score, 0) / scores.length;
        const maxScore = Math.max(...scores);
        const minScore = Math.min(...scores);
        
        industryScores[industryKey] = parseFloat(avgScore.toFixed(1));
        industryStats[industryKey] = {
            name: industryInfo.name,
            companyCount: companies.length,
            avgScore: parseFloat(avgScore.toFixed(1)),
            maxScore: parseFloat(maxScore.toFixed(1)),
            minScore: parseFloat(minScore.toFixed(1)),
            scoreRange: parseFloat((maxScore - minScore).toFixed(1))
        };
    });
    
    return { industryScores, industryStats };
}

// 生成行业分值表HTML
function generateIndustryScoresTableHTML() {
    const { industryStats } = calculateIndustryScoresTable();
    
    // 按平均分值排序
    const sortedIndustries = Object.entries(industryStats)
        .sort(([,a], [,b]) => b.avgScore - a.avgScore);
    
    let html = `
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>排名</th>
                        <th>行业名称</th>
                        <th>公司数量</th>
                        <th>平均分值</th>
                        <th>最高分值</th>
                        <th>最低分值</th>
                        <th>分值范围</th>
                        <th>投资评级</th>
                    </tr>
                </thead>
                <tbody>
    `;
    
    sortedIndustries.forEach(([industryKey, stats], index) => {
        const recommendation = generateRecommendation(stats.avgScore);
        const rankClass = index < 3 ? 'table-success' : (index >= sortedIndustries.length - 3 ? 'table-warning' : '');
        
        html += `
            <tr class="${rankClass}">
                <td><strong>${index + 1}</strong></td>
                <td>${stats.name}</td>
                <td>${stats.companyCount}</td>
                <td><span class="badge bg-primary">${stats.avgScore}</span></td>
                <td><span class="badge bg-success">${stats.maxScore}</span></td>
                <td><span class="badge bg-secondary">${stats.minScore}</span></td>
                <td><span class="badge bg-info">${stats.scoreRange}</span></td>
                <td><span class="badge ${getRecommendationBadgeClass(recommendation)}">${recommendation}</span></td>
            </tr>
        `;
    });
    
    html += `
                </tbody>
            </table>
        </div>
    `;
    
    return html;
}

// 获取推荐等级对应的徽章样式
function getRecommendationBadgeClass(recommendation) {
    switch(recommendation) {
        case '强烈推荐': return 'bg-danger';
        case '推荐': return 'bg-success';
        case '谨慎推荐': return 'bg-warning';
        case '中性': return 'bg-info';
        default: return 'bg-secondary';
    }
}

function calculateCompositeScore(financial, market, industry) {
    // 加权综合评分：财务40%，市场30%，行业30%
    return parseFloat((financial * 0.4 + market * 0.3 + industry * 0.3).toFixed(1));
}

function generateRecommendation(score) {
    if (score >= 9.0) return '强烈推荐';
    if (score >= 8.0) return '推荐';
    if (score >= 7.0) return '谨慎推荐';
    if (score >= 6.0) return '中性';
    return '观望';
}

function generateMarketSector(code) {
    if (code.startsWith('60')) return '主板';
    if (code.startsWith('00')) return '主板';
    if (code.startsWith('30')) return '创业板';
    if (code.startsWith('68')) return '科创板';
    return '主板';
}

// 批量评分功能
function startBatchScoring() {
    const batchScope = document.getElementById('batchScope').value;
    const scoreDimensions = document.getElementById('scoreDimensions').value;
    const scoreAlgorithm = document.getElementById('scoreAlgorithm').value;
    
    const progressBar = document.getElementById('batchProgress');
    const statusText = document.getElementById('batchStatus');
    
    progressBar.style.display = 'block';
    statusText.textContent = '开始生成A股公司数据...';
    
    // 模拟批量评分过程
    let progress = 0;
    const interval = setInterval(() => {
        progress += 5;
        progressBar.querySelector('.progress-bar').style.width = progress + '%';
        
        if (progress <= 25) {
            statusText.textContent = '正在生成公司基础数据...';
        } else if (progress <= 50) {
            statusText.textContent = '正在计算财务指标评分...';
        } else if (progress <= 75) {
            statusText.textContent = '正在计算市场表现评分...';
        } else {
            statusText.textContent = '正在计算行业前景评分...';
        }
        
        if (progress >= 100) {
            clearInterval(interval);
            statusText.textContent = '批量评分完成！';
            
            // 生成A股公司数据
            allCompaniesData = generateAStockCompanies();
            filteredData = [...allCompaniesData].sort((a, b) => b.compositeScore - a.compositeScore);
            
            // 更新总数显示
            document.getElementById('totalCompanies').textContent = `总计: ${allCompaniesData.length}家公司`;
            
            // 显示第一页数据
            displayCurrentPage();
        }
    }, 200);
}

// 显示当前页数据
function displayCurrentPage() {
    const tableBody = document.getElementById('matrixTableBody');
    const startIndex = (currentPage - 1) * pageSize;
    const endIndex = startIndex + pageSize;
    const pageData = filteredData.slice(startIndex, endIndex);
    
    let tableHTML = '';
    
    pageData.forEach((item, index) => {
        const rank = startIndex + index + 1;
        const compositeColor = item.compositeScore >= 9.0 ? 'success' : 
                             item.compositeScore >= 8.0 ? 'warning' : 'danger';
        const recommendationColor = item.recommendation === '强烈推荐' ? 'success' :
                                  item.recommendation === '推荐' ? 'info' :
                                  item.recommendation === '谨慎推荐' ? 'warning' : 'secondary';
        
        tableHTML += `
            <tr class="${item.compositeScore >= 9.0 ? 'table-success' : item.compositeScore >= 8.0 ? 'table-warning' : ''}">
                <td><span class="badge bg-primary">${rank}</span></td>
                <td><strong>${item.companyName}</strong></td>
                <td>${item.stockCode}</td>
                <td><span class="badge bg-secondary">${item.industry}</span></td>
                <td><span class="badge bg-info">${item.marketSector}</span></td>
                <td>
                    <div class="progress" style="height: 15px;">
                        <div class="progress-bar bg-info" role="progressbar" style="width: ${item.financialScore * 10}%">
                            ${item.financialScore}
                        </div>
                    </div>
                </td>
                <td>
                    <div class="progress" style="height: 15px;">
                        <div class="progress-bar bg-warning" role="progressbar" style="width: ${item.marketScore * 10}%">
                            ${item.marketScore}
                        </div>
                    </div>
                </td>
                <td>
                    <div class="progress" style="height: 15px;">
                        <div class="progress-bar bg-success" role="progressbar" style="width: ${item.industryScore * 10}%">
                            ${item.industryScore}
                        </div>
                    </div>
                </td>
                <td>
                    <span class="badge bg-${compositeColor}">${item.compositeScore}</span>
                    <div class="progress mt-1" style="height: 8px;">
                        <div class="progress-bar bg-${compositeColor}" role="progressbar" style="width: ${item.compositeScore * 10}%"></div>
                    </div>
                </td>
                <td><span class="badge bg-${recommendationColor}">${item.recommendation}</span></td>
                <td>
                    <button class="btn btn-sm btn-outline-primary" onclick="viewMatrixDetail('${item.stockCode}')">
                        <i class="bi bi-eye"></i> 详情
                    </button>
                </td>
            </tr>
        `;
    });
    
    tableBody.innerHTML = tableHTML;
    updatePageInfo();
}

// 更新分页信息
function updatePageInfo() {
    const totalPages = Math.ceil(filteredData.length / pageSize);
    document.getElementById('pageInfo').textContent = `第 ${currentPage} 页，共 ${totalPages} 页`;
}

// 分页功能
function changePageSize() {
    pageSize = parseInt(document.getElementById('pageSize').value);
    currentPage = 1;
    displayCurrentPage();
}

function previousPage() {
    if (currentPage > 1) {
        currentPage--;
        displayCurrentPage();
    }
}

function nextPage() {
    const totalPages = Math.ceil(filteredData.length / pageSize);
    if (currentPage < totalPages) {
        currentPage++;
        displayCurrentPage();
    }
}

// 筛选功能
function filterMatrixData() {
    const industry = document.getElementById('industrySelect').value;
    const marketSector = document.getElementById('marketSector').value;
    const scoreRange = document.getElementById('compositeScoreRange').value;
    const searchText = document.getElementById('companySearch').value.toLowerCase();
    
    filteredData = allCompaniesData.filter(company => {
        // 行业筛选
        if (industry !== 'all' && company.industryKey !== industry) return false;
        
        // 市场板块筛选
        if (marketSector !== 'all' && company.marketSector !== marketSector) return false;
        
        // 评分范围筛选
        if (scoreRange !== 'all') {
            if (scoreRange === 'excellent' && company.compositeScore < 9.0) return false;
            if (scoreRange === 'good' && (company.compositeScore < 8.0 || company.compositeScore >= 9.0)) return false;
            if (scoreRange === 'average' && (company.compositeScore < 6.0 || company.compositeScore >= 8.0)) return false;
            if (scoreRange === 'poor' && company.compositeScore >= 6.0) return false;
        }
        
        // 搜索筛选
        if (searchText && !company.companyName.toLowerCase().includes(searchText) && 
            !company.stockCode.includes(searchText)) return false;
        
        return true;
    });
    
    // 按综合评分排序
    filteredData.sort((a, b) => b.compositeScore - a.compositeScore);
    currentPage = 1;
    displayCurrentPage();
}

// 重置筛选
function resetFilters() {
    document.getElementById('industrySelect').value = 'all';
    document.getElementById('marketSector').value = 'all';
    document.getElementById('compositeScoreRange').value = 'all';
    document.getElementById('companySearch').value = '';
    
    filteredData = [...allCompaniesData].sort((a, b) => b.compositeScore - a.compositeScore);
    currentPage = 1;
    displayCurrentPage();
}

// 刷新数据
function refreshMatrixData() {
    if (allCompaniesData.length === 0) {
        alert('请先进行批量评分生成数据');
        return;
    }
    
    // 重新生成数据（模拟数据更新）
    allCompaniesData = generateAStockCompanies();
    filteredData = [...allCompaniesData].sort((a, b) => b.compositeScore - a.compositeScore);
    currentPage = 1;
    displayCurrentPage();
    
    alert('数据已刷新完成！');
}

// 导出全部数据
function exportAllData() {
    if (allCompaniesData.length === 0) {
        alert('请先进行批量评分生成数据');
        return;
    }
    
    // 模拟导出功能
    const csvContent = generateCSVContent(allCompaniesData);
    downloadCSV(csvContent, 'A股公司综合评分.csv');
    alert('数据导出完成！');
}

function generateCSVContent(data) {
    let csv = `排名,公司名称,股票代码,所属行业,市场板块,财务评分,市场评分,行业评分,综合评分,投资建议
`;
    
    data.forEach((item, index) => {
        csv += `${index + 1},${item.companyName},${item.stockCode},${item.industry},${item.marketSector},` +
               `${item.financialScore},${item.marketScore},${item.industryScore},${item.compositeScore},${item.recommendation}
`;
    });
    
    return csv;
}

function downloadCSV(content, filename) {
    const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    const url = URL.createObjectURL(blob);
    link.setAttribute('href', url);
    link.setAttribute('download', filename);
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

// 加载矩阵数据
function loadMatrixData() {
    if (allCompaniesData.length === 0) {
        // 如果没有数据，先生成数据
        allCompaniesData = generateAStockCompanies();
    }
    
    // 显示加载状态
    const tableBody = document.getElementById('matrixTableBody');
    tableBody.innerHTML = `
        <tr>
            <td colspan="9" class="text-center py-4">
                <div class="spinner-border text-success" role="status">
                    <span class="visually-hidden">加载中...</span>
                </div>
                <p class="mt-2">正在加载矩阵数据...</p>
            </td>
        </tr>
    `;
    
    setTimeout(() => {
        // 排序数据
        filteredData = [...allCompaniesData].sort((a, b) => b.compositeScore - a.compositeScore);
        currentPage = 1;
        displayCurrentPage();
        
        // 更新总数显示
        document.getElementById('totalCompanies').textContent = `总计: ${allCompaniesData.length}家公司`;
    }, 1000);
}

// 筛选矩阵数据
function filterMatrixData() {
    const industry = document.getElementById('industrySelect').value;
    const companyScoreRange = document.getElementById('companyScoreRange').value;
    const industryScoreRange = document.getElementById('industryScoreRange').value;
    
    // 显示筛选状态
    const tableBody = document.getElementById('matrixTableBody');
    tableBody.innerHTML = `
        <tr>
            <td colspan="9" class="text-center py-4">
                <div class="spinner-border text-success" role="status">
                    <span class="visually-hidden">加载中...</span>
                </div>
                <p class="mt-2">正在筛选矩阵数据...</p>
            </td>
        </tr>
    `;
    
    setTimeout(() => {
        loadMatrixData(); // 重新加载数据（实际应用中应该根据筛选条件过滤）
    }, 500);
}



// 导出数据
function exportMatrixData() {
    alert('行业+公司矩阵数据导出功能即将完成...');
    // 实际实现中这里应该调用导出API
}

// 查看矩阵详情
function viewMatrixDetail(stockCode) {
    alert(`查看矩阵详情: ${stockCode}`);
    // 实际实现中这里应该跳转到详情页面或显示模态框
}

// 缺失的财务指标生成函数
function generateMarketCap(companyName) {
    // 基于公司名称生成市值（亿元）
    const marketCaps = {
        '工商银行': 18000, '建设银行': 15000, '农业银行': 12000, '中国银行': 10000,
        '贵州茅台': 22000, '宁德时代': 9000, '招商银行': 8000, '中国平安': 7500,
        '五粮液': 6000, '比亚迪': 5500, '中国石油': 8000, '中国石化': 5000,
        '中信证券': 3500, '万科A': 2800, '中国建筑': 2500, '宝钢股份': 1200,
        '中国神华': 4500, '万华化学': 3000, '恒瑞医药': 2800, '格力电器': 2000,
        '美的集团': 3800, '伊利股份': 1800, '海天味业': 2500, '中国中免': 3500,
        '立讯精密': 2200, '中兴通讯': 1500, '三一重工': 1800, '隆基绿能': 3200,
        '用友网络': 1200, '分众传媒': 900, '爱尔眼科': 1800
    };
    
    if (marketCaps[companyName]) {
        return marketCaps[companyName];
    }
    
    // 基于行业平均市值
    return Math.round((500 + Math.random() * 4500) / 100) * 100; // 500-5000亿之间
}

function generatePERatio(companyName) {
    // 市盈率（基于行业特性）
    const peRatios = {
        '贵州茅台': 35, '五粮液': 28, '宁德时代': 40, '比亚迪': 45, '中国平安': 10,
        '工商银行': 5, '建设银行': 5, '中国石油': 8, '中国石化': 6, '招商银行': 7,
        '中信证券': 15, '万科A': 8, '中国建筑': 6, '宝钢股份': 5, '中国神华': 7,
        '万华化学': 12, '恒瑞医药': 30, '格力电器': 9, '美的集团': 14, '伊利股份': 20,
        '海天味业': 25, '中国中免': 28, '立讯精密': 18, '中兴通讯': 15, '三一重工': 10,
        '隆基绿能': 22, '用友网络': 35, '分众传媒': 20, '爱尔眼科': 45
    };
    
    if (peRatios[companyName]) {
        return peRatios[companyName];
    }
    
    return parseFloat((5 + Math.random() * 35).toFixed(1));
}

function generatePBRatio(companyName) {
    // 市净率
    const pbRatios = {
        '贵州茅台': 12, '五粮液': 8, '宁德时代': 6, '比亚迪': 5, '中国平安': 1.2,
        '工商银行': 0.6, '建设银行': 0.6, '中国石油': 0.8, '中国石化': 0.7, '招商银行': 1.0,
        '中信证券': 1.5, '万科A': 0.9, '中国建筑': 0.7, '宝钢股份': 0.6, '中国神华': 1.1,
        '万华化学': 2.5, '恒瑞医药': 4.5, '格力电器': 2.0, '美的集团': 2.8, '伊利股份': 3.2,
        '海天味业': 4.0, '中国中免': 5.5, '立讯精密': 3.0, '中兴通讯': 2.2, '三一重工': 1.8,
        '隆基绿能': 3.5, '用友网络': 4.2, '分众传媒': 2.8, '爱尔眼科': 6.0
    };
    
    if (pbRatios[companyName]) {
        return pbRatios[companyName];
    }
    
    return parseFloat((0.5 + Math.random() * 5.5).toFixed(2));
}

function generateROE(companyName) {
    // 净资产收益率（%）
    const roes = {
        '贵州茅台': 32, '五粮液': 25, '宁德时代': 18, '比亚迪': 15, '中国平安': 16,
        '工商银行': 12, '建设银行': 12, '中国石油': 8, '中国石化': 6, '招商银行': 15,
        '中信证券': 10, '万科A': 18, '中国建筑': 14, '宝钢股份': 8, '中国神华': 13,
        '万华化学': 22, '恒瑞医药': 20, '格力电器': 25, '美的集团': 20, '伊利股份': 22,
        '海天味业': 28, '中国中免': 18, '立讯精密': 16, '中兴通讯': 12, '三一重工': 20,
        '隆基绿能': 15, '用友网络': 12, '分众传媒': 18, '爱尔眼科': 22
    };
    
    if (roes[companyName]) {
        return roes[companyName];
    }
    
    return parseFloat((5 + Math.random() * 25).toFixed(1));
}

function generateRevenueGrowth(companyName) {
    // 营收增长率（%）
    const growths = {
        '贵州茅台': 15, '五粮液': 18, '宁德时代': 45, '比亚迪': 35, '中国平安': 8,
        '工商银行': 5, '建设银行': 5, '中国石油': 3, '中国石化': 2, '招商银行': 10,
        '中信证券': 12, '万科A': 6, '中国建筑': 8, '宝钢股份': 4, '中国神华': 7,
        '万华化学': 20, '恒瑞医药': 15, '格力电器': 8, '美的集团': 12, '伊利股份': 10,
        '海天味业': 12, '中国中免': 25, '立讯精密': 30, '中兴通讯': 8, '三一重工': 15,
        '隆基绿能': 35, '用友网络': 18, '分众传媒': 12, '爱尔眼科': 25
    };
    
    if (growths[companyName]) {
        return growths[companyName];
    }
    
    return parseFloat((-5 + Math.random() * 40).toFixed(1));
}

function generateProfitGrowth(companyName) {
    // 利润增长率（%）
    const profitGrowths = {
        '贵州茅台': 18, '五粮液': 20, '宁德时代': 50, '比亚迪': 40, '中国平安': 10,
        '工商银行': 6, '建设银行': 6, '中国石油': 5, '中国石化': 3, '招商银行': 12,
        '中信证券': 15, '万科A': 8, '中国建筑': 10, '宝钢股份': 6, '中国神华': 9,
        '万华化学': 25, '恒瑞医药': 18, '格力电器': 10, '美的集团': 15, '伊利股份': 12,
        '海天味业': 15, '中国中免': 30, '立讯精密': 35, '中兴通讯': 10, '三一重工': 18,
        '隆基绿能': 40, '用友网络': 20, '分众传媒': 15, '爱尔眼科': 28
    };
    
    if (profitGrowths[companyName]) {
        return profitGrowths[companyName];
    }
    
    return parseFloat((-10 + Math.random() * 45).toFixed(1));
}

// 显示热力图
function showHeatmap() {
    const heatmapChart = document.getElementById('heatmapChart');
    const industryScoresTable = document.getElementById('industryScoresTable');
    const heatmapBtn = document.querySelector('button[onclick="showHeatmap()"]');
    const scoresBtn = document.querySelector('button[onclick="showIndustryScores()"]');
    
    // 切换按钮状态
    heatmapBtn.classList.add('active');
    scoresBtn.classList.remove('active');
    
    // 切换显示
    heatmapChart.style.display = 'block';
    industryScoresTable.style.display = 'none';
    
    // 生成热力图数据
    generateHeatmapData();
}

// 显示行业分值表
function showIndustryScores() {
    const heatmapChart = document.getElementById('heatmapChart');
    const industryScoresTable = document.getElementById('industryScoresTable');
    const heatmapBtn = document.querySelector('button[onclick="showHeatmap()"]');
    const scoresBtn = document.querySelector('button[onclick="showIndustryScores()"]');
    
    // 切换按钮状态
    heatmapBtn.classList.remove('active');
    scoresBtn.classList.add('active');
    
    // 切换显示
    heatmapChart.style.display = 'none';
    industryScoresTable.style.display = 'block';
    
    // 生成行业分值表
    generateIndustryScoresTable();
}

// 生成热力图数据
function generateHeatmapData() {
    const heatmapChart = document.getElementById('heatmapChart');
    
    // 计算行业分值
    const industryScores = calculateIndustryScores();
    
    // 生成热力图HTML
    heatmapChart.innerHTML = `
        <div class="text-center py-4">
            <h5>行业-公司评分分布热力图</h5>
            <div class="mb-3">
                <span class="badge bg-success">高评分</span>
                <span class="badge bg-warning">中评分</span>
                <span class="badge bg-danger">低评分</span>
            </div>
            <div class="heatmap-container" style="height: 300px; overflow: auto;">
                <table class="table table-bordered table-sm">
                    <thead>
                        <tr>
                            <th>行业</th>
                            <th>公司数量</th>
                            <th>平均综合评分</th>
                            <th>评分分布</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${industryScores.map(industry => `
                            <tr>
                                <td><strong>${industry.name}</strong></td>
                                <td>${industry.companyCount}</td>
                                <td>${industry.avgScore.toFixed(2)}</td>
                                <td>
                                    <div class="progress" style="height: 20px;">
                                        <div class="progress-bar bg-success" style="width: ${industry.scoreDistribution.excellent}%">优</div>
                                        <div class="progress-bar bg-warning" style="width: ${industry.scoreDistribution.good}%">良</div>
                                        <div class="progress-bar bg-danger" style="width: ${industry.scoreDistribution.average}%">中</div>
                                        <div class="progress-bar bg-secondary" style="width: ${industry.scoreDistribution.poor}%">差</div>
                                    </div>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
        </div>
    `;
}

// 生成行业分值表
function generateIndustryScoresTable() {
    const industryScoresTable = document.getElementById('industryScoresTable');
    
    // 计算行业分值
    const industryScores = calculateIndustryScores();
    
    // 生成行业分值表HTML
    industryScoresTable.innerHTML = `
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-light">
                    <tr>
                        <th>排名</th>
                        <th>行业名称</th>
                        <th>公司数量</th>
                        <th>平均综合评分</th>
                        <th>财务评分</th>
                        <th>市场评分</th>
                        <th>行业评分</th>
                        <th>投资建议</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
                    ${industryScores.map((industry, index) => `
                        <tr>
                            <td>${index + 1}</td>
                            <td><strong>${industry.name}</strong></td>
                            <td>${industry.companyCount}</td>
                            <td><span class="badge bg-${getScoreBadgeClass(industry.avgScore)}">${industry.avgScore.toFixed(2)}</span></td>
                            <td>${industry.avgFinancialScore.toFixed(2)}</td>
                            <td>${industry.avgMarketScore.toFixed(2)}</td>
                            <td>${industry.avgIndustryScore.toFixed(2)}</td>
                            <td><span class="badge bg-${getRecommendationClass(industry.avgScore)}">${getRecommendation(industry.avgScore)}</span></td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewIndustryDetail('${industry.id}')">
                                    <i class="bi bi-eye"></i> 查看
                                </button>
                            </td>
                        </tr>
                    `).join('')}
                </tbody>
            </table>
        </div>
    `;
}

// 计算行业分值
function calculateIndustryScores() {
    if (allCompaniesData.length === 0) {
        allCompaniesData = generateAStockCompanies();
    }
    
    const industryStats = {};
    
    // 按行业分组统计
    allCompaniesData.forEach(company => {
        if (!industryStats[company.industry]) {
            industryStats[company.industry] = {
                companies: [],
                totalScore: 0,
                totalFinancialScore: 0,
                totalMarketScore: 0,
                totalIndustryScore: 0,
                scoreCounts: { excellent: 0, good: 0, average: 0, poor: 0 }
            };
        }
        
        const stats = industryStats[company.industry];
        stats.companies.push(company);
        stats.totalScore += company.compositeScore;
        stats.totalFinancialScore += company.financialScore;
        stats.totalMarketScore += company.marketScore;
        stats.totalIndustryScore += company.industryScore;
        
        // 统计评分分布
        if (company.compositeScore >= 9.0) stats.scoreCounts.excellent++;
        else if (company.compositeScore >= 8.0) stats.scoreCounts.good++;
        else if (company.compositeScore >= 6.0) stats.scoreCounts.average++;
        else stats.scoreCounts.poor++;
    });
    
    // 计算平均值并生成结果
    return Object.keys(industryStats).map(industryId => {
        const stats = industryStats[industryId];
        const companyCount = stats.companies.length;
        const avgScore = stats.totalScore / companyCount;
        const avgFinancialScore = stats.totalFinancialScore / companyCount;
        const avgMarketScore = stats.totalMarketScore / companyCount;
        const avgIndustryScore = stats.totalIndustryScore / companyCount;
        
        // 计算评分分布百分比
        const total = companyCount;
        const scoreDistribution = {
            excellent: (stats.scoreCounts.excellent / total) * 100,
            good: (stats.scoreCounts.good / total) * 100,
            average: (stats.scoreCounts.average / total) * 100,
            poor: (stats.scoreCounts.poor / total) * 100
        };
        
        return {
            id: industryId,
            name: getIndustryName(industryId),
            companyCount: companyCount,
            avgScore: avgScore,
            avgFinancialScore: avgFinancialScore,
            avgMarketScore: avgMarketScore,
            avgIndustryScore: avgIndustryScore,
            scoreDistribution: scoreDistribution
        };
    }).sort((a, b) => b.avgScore - a.avgScore); // 按平均分降序排序
}

// 获取行业名称
function getIndustryName(industryId) {
    const industryNames = {
        'banking': '银行',
        'securities': '证券',
        'insurance': '保险',
        'real_estate': '房地产',
        'construction': '建筑装饰',
        'steel': '钢铁',
        'nonferrous': '有色金属',
        'coal': '煤炭',
        'petrochemical': '石油化工',
        'chemical': '基础化工',
        'textile': '纺织服装',
        'light_manufacturing': '轻工制造',
        'pharmaceutical': '医药生物',
        'public_utilities': '公用事业',
        'transportation': '交通运输',
        'automotive': '汽车',
        'household_appliances': '家用电器',
        'food_beverage': '食品饮料',
        'agriculture': '农林牧渔',
        'commercial_trade': '商业贸易',
        'leisure_services': '休闲服务',
        'biotechnology': '生物制品',
        'medical_services': '医疗服务',
        'electronics': '电子',
        'computers': '计算机',
        'media': '传媒',
        'communication': '通信',
        'defense_military': '国防军工',
        'mechanical_equipment': '机械设备',
        'electrical_equipment': '电气设备'
    };
    
    return industryNames[industryId] || industryId;
}

// 获取评分徽章类
function getScoreBadgeClass(score) {
    if (score >= 9.0) return 'success';
    if (score >= 8.0) return 'warning';
    if (score >= 6.0) return 'danger';
    return 'secondary';
}

// 获取投资建议
function getRecommendation(score) {
    if (score >= 9.0) return '强烈推荐';
    if (score >= 8.0) return '推荐';
    if (score >= 6.0) return '谨慎关注';
    return '观望';
}

// 获取投资建议类
function getRecommendationClass(score) {
    if (score >= 9.0) return 'success';
    if (score >= 8.0) return 'warning';
    if (score >= 6.0) return 'danger';
    return 'secondary';
}

// 查看行业详情
function viewIndustryDetail(industryId) {
    alert(`查看行业详情: ${getIndustryName(industryId)}`);
    // 实际实现中这里应该显示行业详情模态框
}
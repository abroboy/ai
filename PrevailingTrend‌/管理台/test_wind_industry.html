<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>万得行业分类测试</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1>万得行业分类数据测试</h1>
        <button class="btn btn-primary" onclick="loadData()">加载数据</button>
        <div id="result" class="mt-3"></div>
    </div>

    <script>
        async function loadData() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="spinner-border" role="status"></div> 加载中...';
            
            try {
                const response = await fetch('http://localhost:5001/api/wind-industries');
                let data = [];
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.data) {
                        data = result.data;
                    }
                }
                
                if (data.length === 0) {
                    data = generateMockData();
                }
                
                const level1 = data.filter(item => item.industryLevel === 1);
                const level2 = data.filter(item => item.industryLevel === 2);
                
                let level1Html = '';
                level1.forEach(item => {
                    level1Html += '<li class="list-group-item">' + item.industryName + ' (' + item.industryCode + ')</li>';
                });
                
                let level2Html = '';
                level2.slice(0, 10).forEach(item => {
                    level2Html += '<li class="list-group-item">' + item.industryName + ' (' + item.industryCode + ')</li>';
                });
                
                resultDiv.innerHTML = 
                    '<div class="alert alert-success">' +
                        '<h4>数据加载成功！</h4>' +
                        '<p>总行业数: ' + data.length + '</p>' +
                        '<p>一级行业: ' + level1.length + '</p>' +
                        '<p>二级行业: ' + level2.length + '</p>' +
                    '</div>' +
                    '<div class="row">' +
                        '<div class="col-md-6">' +
                            '<h5>一级行业</h5>' +
                            '<ul class="list-group">' + level1Html + '</ul>' +
                        '</div>' +
                        '<div class="col-md-6">' +
                            '<h5>二级行业</h5>' +
                            '<ul class="list-group">' + level2Html + '</ul>' +
                        '</div>' +
                    '</div>';
                
            } catch (error) {
                resultDiv.innerHTML = 
                    '<div class="alert alert-danger">' +
                        '<h4>加载失败</h4>' +
                        '<p>错误: ' + error.message + '</p>' +
                        '<p>使用模拟数据...</p>' +
                    '</div>';
                
                const data = generateMockData();
                const level1 = data.filter(item => item.industryLevel === 1);
                const level2 = data.filter(item => item.industryLevel === 2);
                
                resultDiv.innerHTML += 
                    '<div class="alert alert-info">' +
                        '<h4>模拟数据</h4>' +
                        '<p>总行业数: ' + data.length + '</p>' +
                        '<p>一级行业: ' + level1.length + '</p>' +
                        '<p>二级行业: ' + level2.length + '</p>' +
                    '</div>';
            }
        }
        
        function generateMockData() {
            return [
                {industryCode: "480100", industryName: "银行", industryLevel: 1},
                {industryCode: "430100", industryName: "房地产开发", industryLevel: 1},
                {industryCode: "490000", industryName: "非银金融", industryLevel: 1},
                {industryCode: "420000", industryName: "交通运输", industryLevel: 1},
                {industryCode: "360000", industryName: "电子", industryLevel: 1},
                {industryCode: "280000", industryName: "电气设备", industryLevel: 1},
                {industryCode: "220000", industryName: "化工", industryLevel: 1},
                {industryCode: "180000", industryName: "食品饮料", industryLevel: 1},
                {industryCode: "120000", industryName: "医药生物", industryLevel: 1},
                {industryCode: "100000", industryName: "计算机", industryLevel: 1},
                {industryCode: "610300", industryName: "白酒", industryLevel: 2},
                {industryCode: "360100", industryName: "半导体", industryLevel: 2},
                {industryCode: "280100", industryName: "电机", industryLevel: 2},
                {industryCode: "220100", industryName: "基础化工", industryLevel: 2},
                {industryCode: "180100", industryName: "食品加工", industryLevel: 2},
                {industryCode: "120100", industryName: "化学制药", industryLevel: 2},
                {industryCode: "100100", industryName: "软件开发", industryLevel: 2},
                {industryCode: "480200", industryName: "保险", industryLevel: 2},
                {industryCode: "430200", industryName: "物业管理", industryLevel: 2},
                {industryCode: "490100", industryName: "证券", industryLevel: 2}
            ];
        }
    </script>
</body>
</html>

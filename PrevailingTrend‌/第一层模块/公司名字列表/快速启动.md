# 公司名字列表模块 - 快速启动指南

## 🚀 5分钟快速启动

### 前置条件
- Python 3.8+ 已安装
- MySQL 数据库已运行
- 网络连接正常

### 步骤1：环境准备 (2分钟)
```bash
# 1. 进入模块目录
cd "第一层模块/公司名字列表"

# 2. 创建虚拟环境
python -m venv venv

# 3. 激活虚拟环境
# Windows:
venv\Scripts\activate
# Linux/Mac:
# source venv/bin/activate

# 4. 安装依赖（最小化安装）
pip install akshare pandas requests mysql-connector-python schedule
```

### 步骤2：数据库初始化 (1分钟)
```bash
# 1. 进入数据库配置目录
cd "../../数据库配置"

# 2. 初始化数据库表
python database_config.py

# 3. 创建数据表
python init_tables.py
```

### 步骤3：测试数据采集 (2分钟)
```bash
# 1. 回到模块目录
cd "../第一层模块/公司名字列表"

# 2. 测试AKShare数据源
python -c "import akshare as ak; print('AKShare测试:'); print(ak.stock_zh_a_spot_em().head())"

# 3. 运行数据采集（根据实施指南中的代码）
# 首先需要创建 company_collector.py 文件
```

## 📁 必需的文件

### 核心文件清单
- `config.py` ✅ (已创建)
- `requirements_free.txt` ✅ (已创建)
- `免费数据源实施指南.md` ✅ (已创建)
- `company_collector.py` (需要根据指南创建)
- `scheduler.py` (可选，用于定时任务)
- `validate_data.py` (可选，用于数据验证)

### 创建核心文件的命令
```bash
# 创建数据采集器文件（从实施指南中复制代码）
# 文件: company_collector.py

# 创建调度器文件（可选）
# 文件: scheduler.py

# 创建验证脚本（可选）
# 文件: validate_data.py
```

## 🏃‍♂️ 一键运行脚本

### Windows批处理脚本 (run.bat)
```batch
@echo off
echo 启动公司数据采集系统...

REM 激活虚拟环境
call venv\Scripts\activate

REM 检查依赖
python -c "import akshare, pandas, requests, mysql.connector; print('依赖包检查通过')" || (
    echo 正在安装依赖...
    pip install akshare pandas requests mysql-connector-python schedule
)

REM 运行数据采集
echo 开始数据采集...
python company_collector.py

REM 验证数据
echo 验证采集数据...
python validate_data.py

echo 任务完成！
pause
```

### Linux/Mac脚本 (run.sh)
```bash
#!/bin/bash
echo "启动公司数据采集系统..."

# 激活虚拟环境
source venv/bin/activate

# 检查依赖
python -c "import akshare, pandas, requests, mysql.connector; print('依赖包检查通过')" || {
    echo "正在安装依赖..."
    pip install akshare pandas requests mysql-connector-python schedule
}

# 运行数据采集
echo "开始数据采集..."
python company_collector.py

# 验证数据
echo "验证采集数据..."
python validate_data.py

echo "任务完成！"
```

## 🔧 故障排除

### 常见问题及解决方案

#### 1. 模块导入错误
```bash
# 错误: ModuleNotFoundError: No module named 'akshare'
# 解决: 检查虚拟环境是否激活
venv\Scripts\activate
pip install akshare
```

#### 2. 数据库连接失败
```bash
# 错误: Can't connect to MySQL server
# 解决: 检查MySQL服务是否启动
net start mysql  # Windows
# sudo systemctl start mysql  # Linux
```

#### 3. 网络连接问题
```bash
# 错误: Network timeout
# 解决: 检查网络连接，或使用国内镜像
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple akshare
```

#### 4. 数据源访问限制
```bash
# 错误: API rate limit exceeded
# 解决: 调整请求频率
# 在config.py中降低rate_limit值
```

## 📊 验证成功标准

### 数据采集成功的标志
1. **日志显示无错误**: 查看company_collector.log文件
2. **数据库有数据**: 运行 `SELECT COUNT(*) FROM company_list`
3. **数据质量正常**: A股公司数量在4000-5000之间
4. **字段完整**: 公司名称、股票代码不为空

### 检查命令
```sql
-- 连接MySQL数据库
mysql -u root -p

-- 使用数据库
USE prevailing_trend;

-- 检查数据总量
SELECT COUNT(*) as '公司总数' FROM company_list;

-- 检查今日数据
SELECT COUNT(*) as '今日数据' FROM company_list WHERE data_date = CURDATE();

-- 检查市场分布
SELECT market as '市场', COUNT(*) as '数量' FROM company_list GROUP BY market;

-- 检查数据源
SELECT data_source as '数据源', COUNT(*) as '数量' FROM company_list GROUP BY data_source;
```

## 🎯 性能期望

### 正常运行指标
- **数据采集时间**: 2-5分钟（取决于网络速度）
- **数据量**: 4000+ 家A股公司
- **成功率**: >95%
- **内存使用**: <500MB
- **磁盘空间**: <100MB（含日志）

### 优化建议
- **批量大小**: 建议500-1000条/批次
- **并发数**: 建议2-4个线程
- **请求间隔**: 建议1-2秒/请求
- **重试次数**: 建议2-3次

## 📅 维护计划

### 日常维护
- **每日**: 检查数据采集日志
- **每周**: 验证数据质量和完整性
- **每月**: 清理老旧数据和日志文件

### 升级路径
1. **免费方案**: AKShare + 东方财富
2. **进阶方案**: 添加Tushare免费版
3. **专业方案**: 升级到Tushare Pro或Wind API

## 🆘 技术支持

### 获取帮助
1. **查看日志**: company_collector.log
2. **检查配置**: config.py中的数据源设置
3. **网络测试**: ping数据源API地址
4. **数据库测试**: 手动连接MySQL验证

### 联系方式
- 查看详细实施指南: `免费数据源实施指南.md`
- 参考数据源方案: `数据源接入方案.md`
- 配置参数说明: `config.py`

---

**🎉 准备就绪！现在可以开始收集股票数据了！**


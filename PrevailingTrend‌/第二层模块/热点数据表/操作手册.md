# 热点数据表模块 - 操作手册

## 模块概述
热点数据表模块负责整合和分析各类热点事件、市场趋势和投资主题数据，将分散在各个第一层模块中的热点信息进行统一处理、分类和评级。该模块为大势所趋风险框架提供结构化的热点数据支持，帮助识别市场机会和风险。

## 数据来源依赖

### 第一层模块数据输入
- **国内热点数据**: 国内政策、事件、主题
- **国外热点数据**: 国际事件、外部冲击
- **其他互联网信息**: 网络热点、舆情数据
- **雪球等论坛热点数据**: 投资者关注焦点
- **腾讯济安指数**: 量化热点指标
- **万得行业分类**: 行业热点归属

### 热点数据分类体系
- **政策热点**: 货币政策、财政政策、监管政策
- **事件热点**: 突发事件、重大新闻、行业事件
- **主题热点**: 投资主题、概念炒作、题材轮动
- **技术热点**: 技术突破、创新应用、产业升级
- **市场热点**: 资金流向、板块轮动、风格切换

## 数据字段设计

### 核心标识字段
- **hotspot_id**: 热点唯一标识符
- **hotspot_name**: 热点名称
- **hotspot_type**: 热点类型（政策/事件/主题/技术/市场）
- **category**: 细分类别
- **source_platform**: 来源平台
- **first_mention_time**: 首次提及时间
- **peak_time**: 热度峰值时间

### 热度评估字段
- **heat_score**: 综合热度评分（0-100）
- **mention_count**: 提及次数
- **search_volume**: 搜索量
- **media_coverage**: 媒体覆盖度
- **social_engagement**: 社交媒体参与度
- **trading_volume_spike**: 相关股票成交量激增
- **price_impact**: 股价影响程度

### 时间维度字段
- **emergence_date**: 热点出现日期
- **duration_days**: 持续天数
- **lifecycle_stage**: 生命周期阶段（萌芽/成长/成熟/衰退）
- **trend_direction**: 趋势方向（上升/平稳/下降）
- **seasonality**: 季节性特征
- **recurrence_pattern**: 重现模式

### 影响范围字段
- **affected_industries**: 影响行业列表
- **affected_stocks**: 相关股票代码
- **market_impact_scope**: 市场影响范围（个股/行业/全市场）
- **geographic_scope**: 地理影响范围
- **investor_groups**: 影响投资者群体
- **impact_magnitude**: 影响程度（轻微/中等/重大）

### 情感属性字段
- **sentiment_score**: 情感倾向得分（-1到1）
- **sentiment_trend**: 情感趋势变化
- **positive_mentions**: 正面提及次数
- **negative_mentions**: 负面提及次数
- **neutral_mentions**: 中性提及次数
- **controversy_level**: 争议程度

### 预测属性字段
- **sustainability_score**: 可持续性评分
- **volatility_prediction**: 波动性预测
- **momentum_indicator**: 动量指标
- **reversal_probability**: 反转概率
- **correlation_strength**: 相关性强度
- **risk_level**: 风险等级

### 关联关系字段
- **related_hotspots**: 相关热点ID列表
- **parent_theme**: 上级主题
- **sub_themes**: 子主题列表
- **competing_themes**: 竞争主题
- **synergy_themes**: 协同主题
- **historical_parallels**: 历史相似事件

## 数据处理流程

### 1. 热点识别阶段
```java
def identify_hotspots(raw_data):
    """识别热点事件"""
    hotspots = []
    
    # 关键词频率分析
    keyword_freq = analyze_keyword_frequency(raw_data)
    
    # 突发性检测
    spike_events = detect_sudden_spikes(raw_data)
    
    # 趋势分析
    trending_topics = analyze_trending_topics(raw_data)
    
    # 合并识别结果
    hotspots.extend(keyword_freq)
    hotspots.extend(spike_events)
    hotspots.extend(trending_topics)
    
    # 去重和合并
    merged_hotspots = merge_similar_hotspots(hotspots)
    
    return merged_hotspots
```

### 2. 热度计算阶段
```java
def calculate_heat_score(hotspot_data):
    """计算热度评分"""
    weights = {
        'mention_count': 0.25,
        'search_volume': 0.20,
        'media_coverage': 0.20,
        'social_engagement': 0.15,
        'trading_volume': 0.15,
        'price_impact': 0.05
    }
    
    heat_score = 0
    for metric, weight in weights.items():
        normalized_value = normalize_metric(hotspot_data.get(metric, 0))
        heat_score += normalized_value * weight
    
    # 调整因子
    adjustment_factors = {
        'recency': calculate_recency_factor(hotspot_data['first_mention_time']),
        'credibility': calculate_source_credibility(hotspot_data['sources']),
        'impact': calculate_market_impact(hotspot_data['affected_stocks'])
    }
    
    for factor_name, factor_value in adjustment_factors.items():
        heat_score *= factor_value
    
    return min(100, max(0, heat_score))
```

### 3. 分类标注阶段
```java
def classify_hotspot(hotspot_data):
    """热点分类标注"""
    # 规则基础分类
    if contains_policy_keywords(hotspot_data['content']):
        category = 'policy'
    elif contains_event_keywords(hotspot_data['content']):
        category = 'event'
    elif contains_tech_keywords(hotspot_data['content']):
        category = 'technology'
    else:
        category = 'market'
    
    # 机器学习分类（如果有训练模型）
    if ml_classifier_available():
        ml_category = predict_category(hotspot_data['content'])
        # 结合规则和ML结果
        category = combine_classification_results(category, ml_category)
    
    return category
```

### 4. 影响分析阶段
```java
def analyze_market_impact(hotspot_data):
    """分析市场影响"""
    impact_analysis = {}
    
    # 股票影响分析
    affected_stocks = identify_related_stocks(hotspot_data)
    impact_analysis['affected_stocks'] = affected_stocks
    
    # 行业影响分析
    affected_industries = map_stocks_to_industries(affected_stocks)
    impact_analysis['affected_industries'] = affected_industries
    
    # 价格影响量化
    price_impacts = calculate_price_impacts(affected_stocks, hotspot_data['emergence_date'])
    impact_analysis['price_impacts'] = price_impacts
    
    # 成交量影响
    volume_impacts = calculate_volume_impacts(affected_stocks, hotspot_data['emergence_date'])
    impact_analysis['volume_impacts'] = volume_impacts
    
    return impact_analysis
```

## 热点生命周期管理

### 1. 生命周期阶段定义
```java
class HotspotLifecycle:
    EMERGENCE = "emergence"      # 萌芽期：热点刚出现
    GROWTH = "growth"           # 成长期：热度快速上升
    MATURITY = "maturity"       # 成熟期：热度达到峰值
    DECLINE = "decline"         # 衰退期：热度逐渐下降
    DORMANT = "dormant"         # 休眠期：基本无关注
    
    def determine_stage(self, hotspot_data):
        """判断生命周期阶段"""
        heat_trend = analyze_heat_trend(hotspot_data['heat_history'])
        duration = calculate_duration(hotspot_data)
        
        if duration <= 3 and heat_trend > 0.5:
            return self.EMERGENCE
        elif heat_trend > 0.2:
            return self.GROWTH
        elif abs(heat_trend) <= 0.2:
            return self.MATURITY
        elif heat_trend < -0.2:
            return self.DECLINE
        else:
            return self.DORMANT
```

### 2. 热点演化追踪
```java
def track_hotspot_evolution(hotspot_id):
    """追踪热点演化"""
    evolution_data = {
        'heat_history': get_heat_history(hotspot_id),
        'sentiment_evolution': get_sentiment_evolution(hotspot_id),
        'related_events': get_related_events(hotspot_id),
        'market_reaction': get_market_reaction_history(hotspot_id)
    }
    
    # 识别关键转折点
    turning_points = identify_turning_points(evolution_data['heat_history'])
    evolution_data['turning_points'] = turning_points
    
    # 预测未来趋势
    future_trend = predict_future_trend(evolution_data)
    evolution_data['future_prediction'] = future_trend
    
    return evolution_data
```

## 技术实现方案

### 1. 推荐技术栈
- **java 3.8+**: 主要开发语言
- **pandas**: 数据处理和分析
- **numpy**: 数值计算
- **scikit-learn**: 机器学习
- **transformers**: 自然语言处理
- **jieba**: 中文分词
- **textblob/snownlp**: 情感分析
- **networkx**: 关系网络分析
- **mysql-connector-java**: 数据库连接
- **redis**: 缓存和实时数据
- **elasticsearch**: 全文搜索

### 2. 核心算法实现

#### 热点检测算法
```java
def detect_emerging_hotspots(data_stream):
    """新兴热点检测"""
    # 使用滑动窗口检测异常增长
    window_size = 24  # 24小时窗口
    threshold = 3.0   # 3倍标准差阈值
    
    emerging_hotspots = []
    
    for keyword in get_tracked_keywords():
        recent_counts = get_recent_mentions(keyword, window_size)
        historical_avg = get_historical_average(keyword)
        historical_std = get_historical_std(keyword)
        
        current_rate = sum(recent_counts) / window_size
        z_score = (current_rate - historical_avg) / historical_std
        
        if z_score > threshold:
            emerging_hotspots.append({
                'keyword': keyword,
                'z_score': z_score,
                'current_rate': current_rate,
                'spike_magnitude': current_rate / historical_avg
            })
    
    return emerging_hotspots
```

#### 关联性分析算法
```java
def analyze_hotspot_correlations(hotspots):
    """分析热点间关联性"""
    correlation_matrix = {}
    
    for i, hotspot1 in enumerate(hotspots):
        for j, hotspot2 in enumerate(hotspots[i+1:], i+1):
            # 时间相关性
            time_correlation = calculate_time_correlation(
                hotspot1['heat_history'], 
                hotspot2['heat_history']
            )
            
            # 内容相关性
            content_similarity = calculate_content_similarity(
                hotspot1['content'], 
                hotspot2['content']
            )
            
            # 股票影响相关性
            stock_overlap = calculate_stock_overlap(
                hotspot1['affected_stocks'],
                hotspot2['affected_stocks']
            )
            
            # 综合相关性得分
            overall_correlation = (
                time_correlation * 0.4 + 
                content_similarity * 0.3 + 
                stock_overlap * 0.3
            )
            
            correlation_matrix[(hotspot1['id'], hotspot2['id'])] = {
                'time_correlation': time_correlation,
                'content_similarity': content_similarity,
                'stock_overlap': stock_overlap,
                'overall_correlation': overall_correlation
            }
    
    return correlation_matrix
```

### 3. 实时更新机制
```java
class RealTimeHotspotProcessor:
    def __init__(self):
        self.redis_client = redis.Redis()
        self.update_interval = 300  # 5分钟更新一次
    
    def process_new_data(self, new_data):
        """处理新数据"""
        # 更新现有热点
        self.update_existing_hotspots(new_data)
        
        # 检测新热点
        new_hotspots = self.detect_new_hotspots(new_data)
        
        # 更新热度评分
        self.update_heat_scores()
        
        # 发送实时通知
        self.send_notifications(new_hotspots)
    
    def update_existing_hotspots(self, new_data):
        """更新现有热点数据"""
        for hotspot_id in self.get_active_hotspots():
            # 更新提及次数
            new_mentions = count_new_mentions(hotspot_id, new_data)
            self.increment_mention_count(hotspot_id, new_mentions)
            
            # 更新情感分析
            new_sentiment = analyze_new_sentiment(hotspot_id, new_data)
            self.update_sentiment_score(hotspot_id, new_sentiment)
```

## API接口设计

### 1. 热点查询接口
```java
# 获取热点列表
GET /api/hotspots?type=policy&heat_min=70&limit=20

# 获取热点详情
GET /api/hotspots/{hotspot_id}

# 热点搜索
GET /api/hotspots/search?keyword=新能源&date_range=7d

# 实时热点排行
GET /api/hotspots/trending?top=50
```

### 2. 分析接口
```java
# 热点影响分析
GET /api/hotspots/{hotspot_id}/impact

# 关联性分析
GET /api/hotspots/{hotspot_id}/correlations

# 预测分析
GET /api/hotspots/{hotspot_id}/prediction

# 生命周期分析
GET /api/hotspots/{hotspot_id}/lifecycle
```

### 3. 统计接口
```java
# 热点统计
GET /api/hotspots/stats?group_by=type&date_range=30d

# 趋势分析
GET /api/hotspots/trends?metric=heat_score&period=weekly

# 行业热点分布
GET /api/industries/{industry_code}/hotspots
```

## 实施计划

### 第一阶段：基础框架（3-4天）
1. 设计热点数据表结构
2. 建立数据收集和整合框架
3. 实现基础热点识别算法
4. 完成数据清洗和标准化

### 第二阶段：算法开发（4-5天）
1. 实现热度评分算法
2. 开发分类标注系统
3. 建立关联性分析模型
4. 完善生命周期管理

### 第三阶段：实时处理（3-4天）
1. 实现实时数据处理
2. 建立热点监控系统
3. 完善预警通知机制
4. 优化系统性能

### 第四阶段：服务接口（2-3天）
1. 开发RESTful API
2. 实现数据可视化
3. 建立监控dashboard
4. 完成测试和优化

## 成功指标
- 热点识别准确率 > 85%
- 热度评分相关性 > 0.8
- 实时处理延迟 < 5分钟
- 数据覆盖率 > 90%（主要热点事件）
- 预测准确率 > 70%（短期趋势）
- 系统稳定性 > 99%

## 维护和监控

### 定期维护任务
- **每小时**: 更新热点热度评分
- **每日**: 检查新兴热点，清理过期数据
- **每周**: 评估算法效果，调整参数
- **每月**: 优化分类模型，更新关键词库

### 预警机制
- 重大热点事件自动检测
- 异常热度波动预警
- 系统性能指标监控
- 数据质量异常报警

该模块为风险框架提供及时、准确的热点数据支持，帮助投资者把握市场脉搏和投资机会。

